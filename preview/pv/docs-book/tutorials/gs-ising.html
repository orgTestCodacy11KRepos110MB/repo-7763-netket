
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ground-State: Ising model &#8212; NetKet</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=84ace793992934648b4de8eed757e5a2" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.9d8b4a8b9bb19db25eeaddc40d639ba2.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<div class="col-12 col-md-3 bd-sidebar site-navigation " id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo_simple.jpg" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../docs2/install.html">
   Installation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="j1j2.html">
   Ground-State: J1-J2 model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="G-CNN_Honeycomb.html">
   Symmetries: Honeycomb Heisenberg model
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Reference Documentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/changelog.html">
   Change Log
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/superop.html">
   The Lindblad Master Equation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/hilbert.html">
   The Hilbert module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/operator.html">
   The Operator module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/varstate.html">
   The Variational State Interface
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/sr.html">
   Quantum Geometric Tensor and Stochastic Reconfiguration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/drivers.html">
   The Drivers API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/sharp-bits.html">
   ðŸ”ª The Sharp Bits ðŸ”ª
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  API documentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/api-stability.html">
   API Stability
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../api/api.html">
   Public API
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/graph.html">
     netket.graph
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.AbstractGraph.html">
       netket.graph.AbstractGraph
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Graph.html">
       netket.graph.Graph
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Lattice.html">
       netket.graph.Lattice
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Edgeless.html">
       netket.graph.Edgeless
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Hypercube.html">
       netket.graph.Hypercube
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.lattice.LatticeSite.html">
       netket.graph.lattice.LatticeSite
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Grid.html">
       netket.graph.Grid
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Diamond.html">
       netket.graph.Diamond
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Kagome.html">
       netket.graph.Kagome
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Square.html">
       netket.graph.Square
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Chain.html">
       netket.graph.Chain
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Cube.html">
       netket.graph.Cube
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.BCC.html">
       netket.graph.BCC
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.FCC.html">
       netket.graph.FCC
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Honeycomb.html">
       netket.graph.Honeycomb
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.KitaevHoneycomb.html">
       netket.graph.KitaevHoneycomb
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Triangular.html">
       netket.graph.Triangular
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Pyrochlore.html">
       netket.graph.Pyrochlore
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.DoubledGraph.html">
       netket.graph.DoubledGraph
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.disjoint_union.html">
       netket.graph.disjoint_union
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/hilbert.html">
     netket.hilbert
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.AbstractHilbert.html">
       netket.hilbert.AbstractHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.ContinuousHilbert.html">
       netket.hilbert.ContinuousHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.DiscreteHilbert.html">
       netket.hilbert.DiscreteHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.HomogeneousHilbert.html">
       netket.hilbert.HomogeneousHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.CustomHilbert.html">
       netket.hilbert.CustomHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.TensorHilbert.html">
       netket.hilbert.TensorHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.DoubledHilbert.html">
       netket.hilbert.DoubledHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.Spin.html">
       netket.hilbert.Spin
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.Qubit.html">
       netket.hilbert.Qubit
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.Fock.html">
       netket.hilbert.Fock
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.Particle.html">
       netket.hilbert.Particle
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/operator.html">
     netket.operator
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.AbstractOperator.html">
       netket.operator.AbstractOperator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.AbstractSuperOperator.html">
       netket.operator.AbstractSuperOperator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.DiscreteOperator.html">
       netket.operator.DiscreteOperator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.BoseHubbard.html">
       netket.operator.BoseHubbard
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.GraphOperator.html">
       netket.operator.GraphOperator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.LocalOperator.html">
       netket.operator.LocalOperator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.Ising.html">
       netket.operator.Ising
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.Heisenberg.html">
       netket.operator.Heisenberg
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.PauliStrings.html">
       netket.operator.PauliStrings
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.LocalLiouvillian.html">
       netket.operator.LocalLiouvillian
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.boson.create.html">
       netket.operator.boson.create
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.boson.destroy.html">
       netket.operator.boson.destroy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.boson.number.html">
       netket.operator.boson.number
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.boson.proj.html">
       netket.operator.boson.proj
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.spin.sigmax.html">
       netket.operator.spin.sigmax
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.spin.sigmay.html">
       netket.operator.spin.sigmay
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.spin.sigmaz.html">
       netket.operator.spin.sigmaz
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.spin.sigmap.html">
       netket.operator.spin.sigmap
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.spin.sigmam.html">
       netket.operator.spin.sigmam
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.ContinuousOperator.html">
       netket.operator.ContinuousOperator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.KineticEnergy.html">
       netket.operator.KineticEnergy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.PotentialEnergy.html">
       netket.operator.PotentialEnergy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.SumOperator.html">
       netket.operator.SumOperator
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/exact.html">
     netket.exact
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/exact/netket.exact.full_ed.html">
       netket.exact.full_ed
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/exact/netket.exact.lanczos_ed.html">
       netket.exact.lanczos_ed
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/exact/netket.exact.steady_state.html">
       netket.exact.steady_state
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/sampler.html">
     netket.sampler
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.Sampler.html">
       netket.sampler.Sampler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.SamplerState.html">
       netket.sampler.SamplerState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisSamplerState.html">
       netket.sampler.MetropolisSamplerState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisRule.html">
       netket.sampler.MetropolisRule
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.ExactSampler.html">
       netket.sampler.ExactSampler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisSampler.html">
       netket.sampler.MetropolisSampler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisSamplerNumpy.html">
       netket.sampler.MetropolisSamplerNumpy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.ARDirectSampler.html">
       netket.sampler.ARDirectSampler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisLocal.html">
       netket.sampler.MetropolisLocal
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisExchange.html">
       netket.sampler.MetropolisExchange
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisHamiltonian.html">
       netket.sampler.MetropolisHamiltonian
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisRule.html">
       netket.sampler.MetropolisRule
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.rules.LocalRule.html">
       netket.sampler.rules.LocalRule
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.rules.ExchangeRule.html">
       netket.sampler.rules.ExchangeRule
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.rules.HamiltonianRule.html">
       netket.sampler.rules.HamiltonianRule
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.rules.HamiltonianRuleNumpy.html">
       netket.sampler.rules.HamiltonianRuleNumpy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.rules.CustomRuleNumpy.html">
       netket.sampler.rules.CustomRuleNumpy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.SamplerState.html">
       netket.sampler.SamplerState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisSamplerState.html">
       netket.sampler.MetropolisSamplerState
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/models.html">
     netket.models
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.RBM.html">
       netket.models.RBM
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.RBMModPhase.html">
       netket.models.RBMModPhase
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.RBMMultiVal.html">
       netket.models.RBMMultiVal
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.RBMSymm.html">
       netket.models.RBMSymm
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.Jastrow.html">
       netket.models.Jastrow
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.MPSPeriodic.html">
       netket.models.MPSPeriodic
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.NDM.html">
       netket.models.NDM
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.GCNN.html">
       netket.models.GCNN
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.AbstractARNN.html">
       netket.models.AbstractARNN
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.ARNNDense.html">
       netket.models.ARNNDense
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.ARNNConv1D.html">
       netket.models.ARNNConv1D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.ARNNConv2D.html">
       netket.models.ARNNConv2D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.FastARNNConv1D.html">
       netket.models.FastARNNConv1D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.FastARNNConv2D.html">
       netket.models.FastARNNConv2D
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/nn.html">
     netket.nn
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.Dense.html">
       netket.nn.Dense
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.DenseGeneral.html">
       netket.nn.DenseGeneral
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.DenseSymm.html">
       netket.nn.DenseSymm
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.DenseEquivariant.html">
       netket.nn.DenseEquivariant
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.Conv.html">
       netket.nn.Conv
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.Embed.html">
       netket.nn.Embed
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.MaskedDense1D.html">
       netket.nn.MaskedDense1D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.MaskedConv1D.html">
       netket.nn.MaskedConv1D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.MaskedConv2D.html">
       netket.nn.MaskedConv2D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.celu.html">
       netket.nn.celu
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.elu.html">
       netket.nn.elu
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.gelu.html">
       netket.nn.gelu
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.glu.html">
       netket.nn.glu
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.log_sigmoid.html">
       netket.nn.log_sigmoid
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.log_softmax.html">
       netket.nn.log_softmax
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.relu.html">
       netket.nn.relu
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.sigmoid.html">
       netket.nn.sigmoid
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.soft_sign.html">
       netket.nn.soft_sign
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.softmax.html">
       netket.nn.softmax
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.softplus.html">
       netket.nn.softplus
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.swish.html">
       netket.nn.swish
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.log_cosh.html">
       netket.nn.log_cosh
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.reim_relu.html">
       netket.nn.reim_relu
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.reim_selu.html">
       netket.nn.reim_selu
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/jax.html">
     netket.jax
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.HashablePartial.html">
       netket.jax.HashablePartial
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.PRNGKey.html">
       netket.jax.PRNGKey
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.PRNGSeq.html">
       netket.jax.PRNGSeq
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.mpi_split.html">
       netket.jax.mpi_split
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_dot.html">
       netket.jax.tree_dot
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_axpy.html">
       netket.jax.tree_axpy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_cast.html">
       netket.jax.tree_cast
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_conj.html">
       netket.jax.tree_conj
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_size.html">
       netket.jax.tree_size
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_leaf_iscomplex.html">
       netket.jax.tree_leaf_iscomplex
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_ishomogeneous.html">
       netket.jax.tree_ishomogeneous
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_ravel.html">
       netket.jax.tree_ravel
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_to_real.html">
       netket.jax.tree_to_real
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.dtype_complex.html">
       netket.jax.dtype_complex
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.is_complex.html">
       netket.jax.is_complex
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.is_complex_dtype.html">
       netket.jax.is_complex_dtype
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.maybe_promote_to_complex.html">
       netket.jax.maybe_promote_to_complex
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.expect.html">
       netket.jax.expect
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.vjp.html">
       netket.jax.vjp
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.chunk.html">
       netket.jax.chunk
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.unchunk.html">
       netket.jax.unchunk
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.vjp_chunked.html">
       netket.jax.vjp_chunked
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.vmap_chunked.html">
       netket.jax.vmap_chunked
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/vqs.html">
     netket.vqs
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
    <label for="toctree-checkbox-10">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/vqs/netket.vqs.VariationalState.html">
       netket.vqs.VariationalState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/vqs/netket.vqs.ExactState.html">
       netket.vqs.ExactState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/vqs/netket.vqs.MCState.html">
       netket.vqs.MCState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/vqs/netket.vqs.MCMixedState.html">
       netket.vqs.MCMixedState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/vqs/netket.vqs.get_local_kernel.html">
       netket.vqs.get_local_kernel
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/vqs/netket.vqs.get_local_kernel_arguments.html">
       netket.vqs.get_local_kernel_arguments
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/optimizer.html">
     netket.optimizer
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
    <label for="toctree-checkbox-11">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.Adam.html">
       netket.optimizer.Adam
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.AdaGrad.html">
       netket.optimizer.AdaGrad
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.Sgd.html">
       netket.optimizer.Sgd
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.Momentum.html">
       netket.optimizer.Momentum
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.RmsProp.html">
       netket.optimizer.RmsProp
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.SR.html">
       netket.optimizer.SR
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.qgt.QGTAuto.html">
       netket.optimizer.qgt.QGTAuto
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.qgt.QGTOnTheFly.html">
       netket.optimizer.qgt.QGTOnTheFly
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.qgt.QGTJacobianPyTree.html">
       netket.optimizer.qgt.QGTJacobianPyTree
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.qgt.QGTJacobianDense.html">
       netket.optimizer.qgt.QGTJacobianDense
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.solver.svd.html">
       netket.optimizer.solver.svd
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.solver.cholesky.html">
       netket.optimizer.solver.cholesky
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.solver.LU.html">
       netket.optimizer.solver.LU
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.solver.solve.html">
       netket.optimizer.solver.solve
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/logging.html">
     netket.logging
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
    <label for="toctree-checkbox-12">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/driver/netket.logging.RuntimeLog.html">
       netket.logging.RuntimeLog
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/driver/netket.logging.JsonLog.html">
       netket.logging.JsonLog
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/driver/netket.logging.StateLog.html">
       netket.logging.StateLog
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/driver/netket.logging.TensorBoardLog.html">
       netket.logging.TensorBoardLog
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/callbacks.html">
     netket.callbacks
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
    <label for="toctree-checkbox-13">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/callbacks/netket.callbacks.EarlyStopping.html">
       netket.callbacks.EarlyStopping
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/callbacks/netket.callbacks.Timeout.html">
       netket.callbacks.Timeout
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/utils.html">
     netket.utils
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
    <label for="toctree-checkbox-14">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/utils/netket.utils.HashableArray.html">
       netket.utils.HashableArray
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/utils/netket.utils.mpi.available.html">
       netket.utils.mpi.available
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/utils/netket.utils.mpi.n_nodes.html">
       netket.utils.mpi.n_nodes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/utils/netket.utils.mpi.rank.html">
       netket.utils.mpi.rank
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/utils/netket.utils.mpi.MPI_jax_comm.html">
       netket.utils.mpi.MPI_jax_comm
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/utils/netket.utils.mpi.MPI_py_comm.html">
       netket.utils.mpi.MPI_py_comm
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../docs/api-experimental.html">
   Experimental API
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/experimental/samplers/netket.experimental.sampler.MetropolisPtSampler.html">
     netket.experimental.sampler.MetropolisPtSampler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/experimental/samplers/netket.experimental.sampler.MetropolisLocalPt.html">
     netket.experimental.sampler.MetropolisLocalPt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/experimental/samplers/netket.experimental.sampler.MetropolisExchangePt.html">
     netket.experimental.sampler.MetropolisExchangePt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/experimental/samplers/netket.experimental.sampler.MetropolisSamplerPmap.html">
     netket.experimental.sampler.MetropolisSamplerPmap
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/experimental/variational/netket.experimental.vqs.variables_from_file.html">
     netket.experimental.vqs.variables_from_file
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/experimental/variational/netket.experimental.vqs.variables_from_tar.html">
     netket.experimental.vqs.variables_from_tar
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../docs/_generated/experimental/dynamics/netket.experimental.driver.TDVP.html">
     netket.experimental.driver.TDVP
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Developer Documentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/contributing.html">
   Contributing to NetKet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../docs/writing-tests.html">
   Writing Tests
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<!-- This is an invisible pixel that we watch to see if we've scrolled. -->
<div class="sbt-scroll-pixel-helper"></div>
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            <div class="topbar-left">
                
                <label class="nav-toggle-button" for="__navigation">
                    <div class="visually-hidden">Toggle navigation</div>
                    <i class="fas fa-bars"></i>
                </label>
                
            </div>
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/tutorials/gs-ising.ipynb.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/netket/netket"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/netket/netket/issues/new?title=Issue%20on%20page%20%2Ftutorials/gs-ising.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/netket/netket/blob/master/tutorials/gs-ising.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#installing-netket">
   0. Installing Netket
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#defining-the-hamiltonian">
   1. Defining The Hamiltonian
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exact-diagonalization">
   2. Exact Diagonalization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mean-field-ansatz">
   3. Mean-Field Ansatz
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#variational-monte-carlo">
   4. Variational Monte Carlo
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-diy-optimisation-loop">
     4a. DIY Optimisation loop
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-use-netket-s-optimisation-driver">
     4b. Use NetKetâ€™s optimisation driver
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#jastrow-ansatz">
   5. Jastrow Ansatz
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#neural-network-quantum-state">
   6. Neural-Network Quantum State
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#translation-symmetry">
   7. Translation Symmetry
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#measuring-other-properties">
   8. Measuring Other Properties
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Ground-State: Ising model</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#installing-netket">
   0. Installing Netket
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#defining-the-hamiltonian">
   1. Defining The Hamiltonian
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exact-diagonalization">
   2. Exact Diagonalization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mean-field-ansatz">
   3. Mean-Field Ansatz
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#variational-monte-carlo">
   4. Variational Monte Carlo
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-diy-optimisation-loop">
     4a. DIY Optimisation loop
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-use-netket-s-optimisation-driver">
     4b. Use NetKetâ€™s optimisation driver
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#jastrow-ansatz">
   5. Jastrow Ansatz
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#neural-network-quantum-state">
   6. Neural-Network Quantum State
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#translation-symmetry">
   7. Translation Symmetry
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#measuring-other-properties">
   8. Measuring Other Properties
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="section" id="ground-state-ising-model">
<h1>Ground-State: Ising model<a class="headerlink" href="#ground-state-ising-model" title="Permalink to this headline">ïƒ</a></h1>
<p>Author: Filippo Vicentini (EPFL-CQSL)</p>
<p>17 November, 2021</p>
<p><a class="reference external" href="https://colab.research.google.com/github/PhilipVinc/NetKet-lectures/blob/master/01_intro.ipynb"><img alt="Open in Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<p>In this Tutorial we will introduce the open-source package <a class="reference external" href="https://www.netket.org/">NetKet</a>, and show some of its functionalities. We will guide you through a relatively simple quantum problem, that however will be a good guide also to address more complex situations.</p>
<p>Specifically, we will study the transverse-field Ising model in one dimension:</p>
<div class="math notranslate nohighlight">
\[ 
\mathcal{H}=\Gamma\sum_{i}\sigma_{i}^{(x)}+V\sum_{i}\sigma_{i}^{(z)}\sigma_{i+1}^{(z)}. 
\]</div>
<p>In the following we assume periodic boundary conditions and we will count lattice sites starting from <span class="math notranslate nohighlight">\( 0 \)</span>, such that <span class="math notranslate nohighlight">\( i=0,1\dots L-1 \)</span> and <span class="math notranslate nohighlight">\(i=L=0\)</span>.</p>
<div class="section" id="installing-netket">
<h2>0. Installing Netket<a class="headerlink" href="#installing-netket" title="Permalink to this headline">ïƒ</a></h2>
<p>If you are executing this notebook on Colab, you will need to install netket. You can do so by running the following cell:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">pip</span> install --quiet netket
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Note: you may need to restart the kernel to use updated packages.
</pre></div>
</div>
</div>
</div>
<p>We also want make to sure that this notebook is running on the cpu.
You can edit the field by changing â€œcpuâ€ to â€œgpuâ€ to make it run on the GPU if you want.
But youâ€™ll need to use much larger systems to see a benefit in the runtime.
For systems with less than 40 spins GPUs slow you down remarkably.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;JAX_PLATFORM_NAME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;cpu&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>You can check that the installation was succesfull doing</p>
</div>
<div class="section" id="defining-the-hamiltonian">
<h2>1. Defining The Hamiltonian<a class="headerlink" href="#defining-the-hamiltonian" title="Permalink to this headline">ïƒ</a></h2>
<p>The first step in our journey consists in defining the Hamiltonian we are interested in.
For this purpose, we first need to define the kind of degrees of freedom we are dealing with (i.e. if we have spins, bosons, fermions etc).
This is done specifying the Hilbert space of the problem. For example, let us concentrate on a problem with 20 spins-1/2.</p>
<p>When building hilbert spaces, in general, the first argument determines the size of the local basis and the latter defines how many modes you have.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">netket</span> <span class="k">as</span> <span class="nn">nk</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">hi</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">hilbert</span><span class="o">.</span><span class="n">Spin</span><span class="p">(</span><span class="n">s</span><span class="o">=</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>NetKetâ€™s Hilbert spaces define the computational basis of the calculation, and are used to label and generate elements from it.
The standard Spin-basis implicitly selects the <code class="docutils literal notranslate"><span class="pre">z</span></code> basis and elements of that basis will be elements <span class="math notranslate nohighlight">\( v\in\{\pm 1\}^N \)</span>.</p>
<p>It is possible to generate random basis elements through the function <code class="docutils literal notranslate"><span class="pre">random_state(rng,</span> <span class="pre">shape,</span> <span class="pre">dtype)</span></code>, where the first argument must be a jax RNG state (usually built with <code class="docutils literal notranslate"><span class="pre">jax.random.PRNGKey(seed)</span></code>, second is an integer or a tuple giving the shape of the samples and the last is the dtype of the generated states.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">jax</span>
<span class="n">hi</span><span class="o">.</span><span class="n">random_state</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">PRNGKey</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>DeviceArray([[ 1., -1., -1.,  1., -1.,  1.,  1., -1., -1., -1., -1., -1.,
              -1., -1., -1., -1.,  1.,  1., -1., -1.],
             [ 1., -1.,  1.,  1., -1.,  1.,  1., -1.,  1., -1., -1., -1.,
               1.,  1.,  1.,  1., -1.,  1., -1.,  1.],
             [-1.,  1.,  1.,  1.,  1., -1., -1.,  1.,  1.,  1., -1.,  1.,
               1.,  1.,  1.,  1., -1.,  1., -1.,  1.]], dtype=float32)
</pre></div>
</div>
</div>
</div>
<p>We now need to specify the Hamiltonian. For this purpose, we will use NetKetâ€™s <code class="docutils literal notranslate"><span class="pre">LocalOperator</span></code> (see details <a class="reference external" href="https://www.netket.org/docs/_generated/operator/netket.operator.LocalOperator.html#netket.operator.LocalOperator">here</a>) which is the sum of arbitrary k-local operators.</p>
<p>In this specifc case, we have a 1-local operator, <span class="math notranslate nohighlight">\( \sigma^{(x)}_i \)</span> and a 2-local operator, <span class="math notranslate nohighlight">\( \sigma^{(z)}_i \sigma^{(z)}_j \)</span>. We then start importing the pauli operators.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">netket.operator.spin</span> <span class="kn">import</span> <span class="n">sigmax</span><span class="p">,</span><span class="n">sigmaz</span> 
</pre></div>
</div>
</div>
</div>
<p>We now take <span class="math notranslate nohighlight">\( \Gamma=-1 \)</span> and start defining the 1-local parts of the Hamiltonian</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Gamma</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">H</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">Gamma</span><span class="o">*</span><span class="n">sigmax</span><span class="p">(</span><span class="n">hi</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)])</span>
</pre></div>
</div>
</div>
</div>
<p>Here we have used a list comprehension to (mildly) show off our ability to write one-liners, however you could have just added the terms one by one in an explicit loop instead (though youâ€™d end up with a whopping 3 lines of code).</p>
<p>We now also add the interaction terms, using the fact that NetKet automatically recognizes products of local operators as tensor products.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V</span><span class="o">=-</span><span class="mi">1</span>
<span class="n">H</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">V</span><span class="o">*</span><span class="n">sigmaz</span><span class="p">(</span><span class="n">hi</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">sigmaz</span><span class="p">(</span><span class="n">hi</span><span class="p">,(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">N</span>) for i in range(N)])
</pre></div>
</div>
</div>
</div>
<p>In general, when manipulating NetKet objects, you should always assume that you can safely operate on them like
you would in mathematical equations, therefore you can sum and multiply them with ease.</p>
</div>
<div class="section" id="exact-diagonalization">
<h2>2. Exact Diagonalization<a class="headerlink" href="#exact-diagonalization" title="Permalink to this headline">ïƒ</a></h2>
<p>Now that we have defined the Hamiltonian, we can already start playing with it. For example, since the number of spins is large but still manageable for exact diagonalization, we can give it a try.</p>
<p>In NetKet this is easily done converting our Hamiltonian operator into a sparse matrix of size <span class="math notranslate nohighlight">\( 2^N \times 2^ N \)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sp_h</span><span class="o">=</span><span class="n">H</span><span class="o">.</span><span class="n">to_sparse</span><span class="p">()</span>
<span class="n">sp_h</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1048576, 1048576)
</pre></div>
</div>
</div>
</div>
<p>Since this is just a regular scipy sparse matrix, we can just use any sparse diagonalization routine in there to find the eigenstates. For example, this will find the two lowest eigenstates</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.sparse.linalg</span> <span class="kn">import</span> <span class="n">eigsh</span>

<span class="n">eig_vals</span><span class="p">,</span> <span class="n">eig_vecs</span> <span class="o">=</span> <span class="n">eigsh</span><span class="p">(</span><span class="n">sp_h</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;SA&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;eigenvalues with scipy sparse:&quot;</span><span class="p">,</span> <span class="n">eig_vals</span><span class="p">)</span>

<span class="n">E_gs</span> <span class="o">=</span> <span class="n">eig_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>eigenvalues with scipy sparse: [-25.49098969 -25.41240947]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="mean-field-ansatz">
<h2>3. Mean-Field Ansatz<a class="headerlink" href="#mean-field-ansatz" title="Permalink to this headline">ïƒ</a></h2>
<p>We now would like to find a variational approximation of the ground state of this Hamiltonian. As a first step, we can try to use a very simple mean field ansatz:</p>
<div class="math notranslate nohighlight">
\[ \langle \sigma^{z}_1,\dots \sigma^{z}_N| \Psi_{\mathrm{mf}} \rangle = \Pi_{i=1}^{N} \Phi(\sigma^{z}_i), \]</div>
<p>where the variational parameters are the single-spin wave functions, which we can further take to be normalized:</p>
<div class="math notranslate nohighlight">
\[ |\Phi(\uparrow)|^2 + |\Phi(\downarrow)|^2 =1, \]</div>
<p>and we can further write <span class="math notranslate nohighlight">\( \Phi(\sigma^z) = \sqrt{P(\sigma^z)}e^{i \phi(\sigma^z)}\)</span>. In order to simplify the presentation, we take here and in the following examples the phase <span class="math notranslate nohighlight">\( \phi=0 \)</span>. In this specific model this is without loss of generality, since it is known that the ground state is real and positive.</p>
<p>For the normalized single-spin probability we will take a sigmoid form:</p>
<p>$<span class="math notranslate nohighlight">\( P(\sigma_z; \lambda) = 1/(1+\exp(-\lambda \sigma_z)), \)</span><span class="math notranslate nohighlight">\( thus depending on the real-valued variational parameter \)</span>\lambda$.</p>
<p>In NetKet one has to define a variational function approximating the <strong>logarithm</strong> of the wave-function amplitudes (or density-matrix values).
We call this variational function <em>the Model</em> (yes, caps on the M).</p>
<p>$<span class="math notranslate nohighlight">\( \langle \sigma^{z}_1,\dots \sigma^{z}_N| \Psi_{\mathrm{mf}} \rangle = \exp\left[\mathrm{Model}(\sigma^{z}_1,\dots \sigma^{z}_N ; \theta ) \right], \)</span><span class="math notranslate nohighlight">\( where \)</span>\theta$ is a set of parameters.</p>
<p>In this case, the parameter of the model will be just one: <span class="math notranslate nohighlight">\(\gamma\)</span>.</p>
<p>The Model can be defined using one of the several <em>functional</em> jax frameworks such as Jax/Stax, Flax or Haiku.
NetKet includes several pre-built models and layers built with <a class="reference external" href="https://github.com/google/flax">Flax</a>, so we will be using it for the rest of the notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># numerical operations in the model should always use jax.numpy </span>
<span class="c1"># instead of numpy because jax supports computing derivatives. </span>
<span class="c1"># If you want to better understand the difference between the two, check</span>
<span class="c1"># https://flax.readthedocs.io/en/latest/notebooks/jax_for_the_impatient.html</span>
<span class="kn">import</span> <span class="nn">jax.numpy</span> <span class="k">as</span> <span class="nn">jnp</span>

<span class="c1"># Flax is a framework to define models using jax</span>
<span class="kn">import</span> <span class="nn">flax</span>
<span class="c1"># we refer to `flax.linen` as `nn`. It&#39;s a repository of </span>
<span class="c1"># layers, initializers and nonlinear functions.</span>
<span class="kn">import</span> <span class="nn">flax.linen</span> <span class="k">as</span> <span class="nn">nn</span>

<span class="c1"># A Flax model must be a class subclassing `nn.Module`</span>
<span class="k">class</span> <span class="nc">MF</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    
    <span class="c1"># The most compact way to define the model is this.</span>
    <span class="c1"># The __call__(self, x) function should take as </span>
    <span class="c1"># input a batch of states x.shape = (n_samples, L)</span>
    <span class="c1"># and should return a vector of n_samples log-amplitudes</span>
    <span class="nd">@nn</span><span class="o">.</span><span class="n">compact</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        
        <span class="c1"># A tensor of variational parameters is defined by calling</span>
        <span class="c1"># the method `self.param` where the arguments will be:</span>
        <span class="c1"># - arbitrary name used to refer to this set of parameters</span>
        <span class="c1"># - an initializer used to provide the initial values. </span>
        <span class="c1"># - The shape of the tensor</span>
        <span class="c1"># - The dtype of the tensor.</span>
        <span class="n">lam</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">(</span>
            <span class="s2">&quot;lambda&quot;</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">normal</span><span class="p">(),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="nb">float</span>
        <span class="p">)</span>
        
        <span class="c1"># compute the probabilities</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">log_sigmoid</span><span class="p">(</span><span class="n">lam</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

        <span class="c1"># sum the output</span>
        <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The model itself is only a set of instructions on how to initialise the parameters and how to compute the result.</p>
<p>To actually create a variational state with its parameters, the easiest way is to construct a Monte-Carlo-sampled Variational State.
To do this, we first need to define a sampler.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">netket.sampler</span></code> several samplers are defined, each with its own peculiarities.
In the following example, we will be using a simple sampler that flips the spins in the configurations one by one.</p>
<p>You can read more about how the sampler works by checking the documentation with <code class="docutils literal notranslate"><span class="pre">?nk.sampler.MetropolisLocal</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create an instance of the model. </span>
<span class="c1"># Notice that this does not create the parameters, but only the specification of how the model is constructed and acts upon inputs/.</span>
<span class="n">mf_model</span> <span class="o">=</span> <span class="n">MF</span><span class="p">()</span>

<span class="c1"># Create the local sampler on the hilbert space</span>
<span class="n">sampler</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">MetropolisLocal</span><span class="p">(</span><span class="n">hi</span><span class="p">)</span>

<span class="c1"># Construct the variational state using the model and the sampler above.</span>
<span class="c1"># n_samples specifies how many samples should be used to compute expectation</span>
<span class="c1"># values.</span>
<span class="n">vstate</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">vqs</span><span class="o">.</span><span class="n">MCState</span><span class="p">(</span><span class="n">sampler</span><span class="p">,</span> <span class="n">mf_model</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="mi">512</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>You can play around with the variational state: for example, you can compute expectation values yourself or inspect itâ€™s parameters.
The parameters are stored as a set of nested dictionaries. In this case, the single parameter <span class="math notranslate nohighlight">\(\lambda\)</span> is stored inside a (frozen) dictionary.
(The reason why the dictionary is frozen is a detail of Flax).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">vstate</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FrozenDict({
    lambda: DeviceArray([-0.00682883], dtype=float64),
})
</pre></div>
</div>
</div>
</div>
<p>With a variational state, you can compute expectation values of operators.
Notice that it also provides an error estimate and the variance of this estimator.
If you are close to an eigenstate of the operators, the variance should be 0 or close to 0.</p>
<p>The <span class="math notranslate nohighlight">\(\hat{R}\)</span> value is a Monte-Carlo convergence estimator. It will be <span class="math notranslate nohighlight">\(\hat{R}\approx 1\)</span> if the Markov Chain is converged, while it will be far from <span class="math notranslate nohighlight">\(1\)</span> if your sampling has not converged.
As a rule of thumb, look out for <span class="math notranslate nohighlight">\(\abs{\hat{R}} &gt; 1.1\)</span>, and check if your sampling scheme or sampler is consistent with your system specification.</p>
<p>You can also investigate the correlation time of your estimator, <span class="math notranslate nohighlight">\(\tau\)</span>. If <span class="math notranslate nohighlight">\(\tau\gg1\)</span> then your samples are very correlated and you most likely have some issues with your sampling scheme.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E</span> <span class="o">=</span> <span class="n">vstate</span><span class="o">.</span><span class="n">expect</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-19.73 Â± 0.20 [ÏƒÂ²=19.68, RÌ‚=0.9998]
</pre></div>
</div>
</div>
</div>
<p>You can also access the fields individually:
Note that if you run your calculation using MPI on different processes/machines, those estimators will return the mean, error and estimators of all the samples across all the processes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mean                  :&quot;</span><span class="p">,</span> <span class="n">E</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error                 :&quot;</span><span class="p">,</span> <span class="n">E</span><span class="o">.</span><span class="n">error_of_mean</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Variance              :&quot;</span><span class="p">,</span> <span class="n">E</span><span class="o">.</span><span class="n">variance</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Convergence indicator :&quot;</span><span class="p">,</span> <span class="n">E</span><span class="o">.</span><span class="n">R_hat</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Correlation time      :&quot;</span><span class="p">,</span> <span class="n">E</span><span class="o">.</span><span class="n">tau_corr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean                  : -19.73437154409286
Error                 : 0.19604177094860048
Variance              : 19.677376489811728
Convergence indicator : 0.9997616734218494
Correlation time      : 0.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vstate</span><span class="o">.</span><span class="n">expect_and_grad</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-19.73 Â± 0.20 [ÏƒÂ²=19.68, RÌ‚=0.9998],
 FrozenDict({
     lambda: DeviceArray([0.13393606], dtype=float64),
 }))
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="variational-monte-carlo">
<h2>4. Variational Monte Carlo<a class="headerlink" href="#variational-monte-carlo" title="Permalink to this headline">ïƒ</a></h2>
<p>We will now try to optimise <span class="math notranslate nohighlight">\( \lambda \)</span> in order to best approximate the ground state of the hamiltonian.</p>
<p>At first, weâ€™ll try to do this by ourself by writing the training loop, but then weâ€™ll switch to using a pre-made
solution provided by netket for simplicity.</p>
<div class="section" id="a-diy-optimisation-loop">
<h3>4a. DIY Optimisation loop<a class="headerlink" href="#a-diy-optimisation-loop" title="Permalink to this headline">ïƒ</a></h3>
<p>The optimisation (or training) loop must do a very simple thing: at every iteration it must compute the energy and itâ€™s gradient, then multiply the gradient by a certain learning rate <span class="math notranslate nohighlight">\(\lambda = 0.05\)</span> and lastly it must update the parameters with this rescaled gradient.
You can do so as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>

<span class="n">energy_history</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">n_steps</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># For every iteration (tqdm is just a progress bar)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">)):</span>
    <span class="c1"># compute energy and gradient of the energy</span>
    <span class="n">E</span><span class="p">,</span> <span class="n">E_grad</span> <span class="o">=</span> <span class="n">vstate</span><span class="o">.</span><span class="n">expect_and_grad</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
    <span class="c1"># log the energy to a list</span>
    <span class="n">energy_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>
    <span class="c1"># equivalent to vstate.parameters - 0.05*E_grad , but it performs this</span>
    <span class="c1"># function on every leaf of the dictionaries containing the set of parameters</span>
    <span class="n">new_pars</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree_multimap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">-</span><span class="mf">0.05</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">vstate</span><span class="o">.</span><span class="n">parameters</span><span class="p">,</span> <span class="n">E_grad</span><span class="p">)</span>
    <span class="c1"># actually update the paramters</span>
    <span class="n">vstate</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="n">new_pars</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [00:01&lt;00:00, 74.91it/s]
</pre></div>
</div>
</div>
</div>
<p>We now can plot the energy during those optimisation steps:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">energy_history</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7f153c503340&gt;]
</pre></div>
</div>
<img alt="../_images/gs-ising_38_1.png" src="../_images/gs-ising_38_1.png" />
</div>
</div>
</div>
<div class="section" id="b-use-netket-s-optimisation-driver">
<h3>4b. Use NetKetâ€™s optimisation driver<a class="headerlink" href="#b-use-netket-s-optimisation-driver" title="Permalink to this headline">ïƒ</a></h3>
<p>As writing the whole optimisation loop by yourself every time is.. boring, we can make use of a coupled of NetKetâ€™s built-in utilities.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First we reset the parameters to run the optimisation again</span>
<span class="n">vstate</span><span class="o">.</span><span class="n">init_parameters</span><span class="p">()</span>

<span class="c1"># Then we create an optimiser from the standard library.</span>
<span class="c1"># You can also use optax.</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">Sgd</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

<span class="c1"># build the optimisation driver</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">VMC</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">variational_state</span><span class="o">=</span><span class="n">vstate</span><span class="p">)</span>

<span class="c1"># run the driver for 300 iterations. This will display a progress bar</span>
<span class="c1"># by default.</span>
<span class="n">gs</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">n_iter</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

<span class="n">mf_energy</span><span class="o">=</span><span class="n">vstate</span><span class="o">.</span><span class="n">expect</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="n">error</span><span class="o">=</span><span class="nb">abs</span><span class="p">((</span><span class="n">mf_energy</span><span class="o">.</span><span class="n">mean</span><span class="o">-</span><span class="n">eig_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">eig_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimized energy and relative error: &quot;</span><span class="p">,</span><span class="n">mf_energy</span><span class="p">,</span><span class="n">error</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No output specified (out=[apath|nk.logging.JsonLogger(...)]).Running the optimization but not saving the output.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 300/300 [00:04&lt;00:00, 72.83it/s, Energy=-24.966 Â± 0.043 [ÏƒÂ²=0.960, RÌ‚=0.9994]]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimized energy and relative error:  -25.021 Â± 0.049 [ÏƒÂ²=1.254, RÌ‚=1.0102] 0.01844338233849268
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we can also inspect the parameter:</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Final optimized parameter: &quot;</span><span class="p">,</span><span class="n">vstate</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;lambda&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final optimized parameter:  [2.64408644]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eig_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-25.49098968636478
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="jastrow-ansatz">
<h2>5. Jastrow Ansatz<a class="headerlink" href="#jastrow-ansatz" title="Permalink to this headline">ïƒ</a></h2>
<p>We have seen that the mean field ansatz yields about 2% error on the ground-state energy. Letâ€™s now try to do better, using a more correlated ansatz.</p>
<p>We will now take a short-range Jastrow ansatz, entangling nearest and next-to nearest neighbors, of the form</p>
<div class="math notranslate nohighlight">
\[ \langle \sigma^{z}_1,\dots \sigma^{z}_N| \Psi_{\mathrm{jas}} \rangle = \exp \left( \sum_i J_1 \sigma^{z}_i\sigma^{z}_{i+1} + J_2 \sigma^{z}_i\sigma^{z}_{i+2} \right),\]</div>
<p>where the parameters <span class="math notranslate nohighlight">\(J_1\)</span> and <span class="math notranslate nohighlight">\(J_2\)</span> are to be learned.</p>
<p>Again we can write the model using flax.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">JasShort</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="nd">@nn</span><span class="o">.</span><span class="n">compact</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        
        <span class="c1"># Define the two variational parameters J1 and J2</span>
        <span class="n">j1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">(</span>
            <span class="s2">&quot;j1&quot;</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">normal</span><span class="p">(),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="nb">float</span>
        <span class="p">)</span>
        <span class="n">j2</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">param</span><span class="p">(</span>
            <span class="s2">&quot;j2&quot;</span><span class="p">,</span> <span class="n">nn</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">normal</span><span class="p">(),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="nb">float</span>
        <span class="p">)</span>

        <span class="c1"># compute the nearest-neighbor correlations</span>
        <span class="n">corr1</span><span class="o">=</span><span class="n">x</span><span class="o">*</span><span class="n">jnp</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">corr2</span><span class="o">=</span><span class="n">x</span><span class="o">*</span><span class="n">jnp</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># sum the output</span>
        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">j1</span><span class="o">*</span><span class="n">corr1</span><span class="o">+</span><span class="n">j2</span><span class="o">*</span><span class="n">corr2</span><span class="p">,</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    
<span class="n">model</span><span class="o">=</span><span class="n">JasShort</span><span class="p">()</span>

<span class="n">vstate</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">vqs</span><span class="o">.</span><span class="n">MCState</span><span class="p">(</span><span class="n">sampler</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="mi">1008</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We then optimize it, however this time we also introduce a stochastic reconfiguration (natural gradient) preconditioner. Also, we now log the intermediate results of the optimization, so that we can visualize them at a later stage.</p>
<p>Loggers that work together with optimisation drivers are defined in <code class="docutils literal notranslate"><span class="pre">nk.logging</span></code>. In this example we use <code class="docutils literal notranslate"><span class="pre">RuntimeLog</span></code>, which keeps the metrics in memory. You could also use <code class="docutils literal notranslate"><span class="pre">JsonLog</span></code>, which stores data to a json file which can be later read as a dict or <code class="docutils literal notranslate"><span class="pre">TensorBoardLog</span></code> which connects to <a class="reference external" href="https://www.tensorflow.org/tensorboard">TensorBoard</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">Sgd</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>

<span class="n">gs</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">VMC</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">variational_state</span><span class="o">=</span><span class="n">vstate</span><span class="p">,</span> <span class="n">preconditioner</span><span class="o">=</span><span class="n">nk</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="n">diag_shift</span><span class="o">=</span><span class="mf">0.1</span><span class="p">))</span>

<span class="c1"># construct the logger</span>
<span class="n">log</span><span class="o">=</span><span class="n">nk</span><span class="o">.</span><span class="n">logging</span><span class="o">.</span><span class="n">RuntimeLog</span><span class="p">()</span>

<span class="c1"># One or more logger objects must be passed to the keyword argument `out`.</span>
<span class="n">gs</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">n_iter</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">log</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Final optimized parameters: j1=</span><span class="si">{</span><span class="n">vstate</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;j1&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, j2=</span><span class="si">{</span><span class="n">vstate</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;j2&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">jas_energy</span><span class="o">=</span><span class="n">vstate</span><span class="o">.</span><span class="n">expect</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="n">error</span><span class="o">=</span><span class="nb">abs</span><span class="p">((</span><span class="n">jas_energy</span><span class="o">.</span><span class="n">mean</span><span class="o">-</span><span class="n">eig_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">eig_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimized energy : </span><span class="si">{</span><span class="n">jas_energy</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;relative error   : </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 300/300 [00:03&lt;00:00, 75.17it/s, Energy=-25.287 Â± 0.020 [ÏƒÂ²=0.391, RÌ‚=1.0018]]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Final optimized parameters: j1=[0.23307136], j2=[0.08333842]
Optimized energy : -25.329 Â± 0.021 [ÏƒÂ²=0.446, RÌ‚=1.0056]
relative error   : 0.006346827540707313
</pre></div>
</div>
</div>
</div>
<p>You can now see that this ansatz is almost one order of magnitude more accurate than the mean field!</p>
<p>In order to visualize what happened during the optimization, we can use the data that has been stored by the logger. There are several available loggers in NetKet, here we have just used a simple one that stores the intermediate results as values in a dictionary.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_jastrow</span> <span class="o">=</span> <span class="n">log</span><span class="o">.</span><span class="n">data</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_jastrow</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Energy&#39;: History(
   keys  = [&#39;Mean&#39;, &#39;Variance&#39;, &#39;Sigma&#39;, &#39;R_hat&#39;, &#39;TauCorr&#39;], 
   iters = [0, 1, ... 298, 299] (300 steps),
)}
</pre></div>
</div>
</div>
</div>
<p>These report several intermediate quantities, that can be easily plotted. For example we can plot the value of the energy (with its error bar) at each optimization step.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">data_jastrow</span><span class="p">[</span><span class="s2">&quot;Energy&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iters</span><span class="p">,</span> <span class="n">data_jastrow</span><span class="p">[</span><span class="s2">&quot;Energy&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">Mean</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">data_jastrow</span><span class="p">[</span><span class="s2">&quot;Energy&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">Sigma</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Iterations&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Energy&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Energy&#39;)
</pre></div>
</div>
<img alt="../_images/gs-ising_50_1.png" src="../_images/gs-ising_50_1.png" />
</div>
</div>
</div>
<div class="section" id="neural-network-quantum-state">
<h2>6. Neural-Network Quantum State<a class="headerlink" href="#neural-network-quantum-state" title="Permalink to this headline">ïƒ</a></h2>
<p>We now want to use a more sofisticated ansatz, based on a neural network representation of the wave function. At this point, this is quite straightforward, since we can again take advantage of automatic differentiation.</p>
<p>Let us define a simple fully-connected feed-forward network with a ReLu activation function and a sum layer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">FFN</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    
    <span class="c1"># You can define attributes at the module-level</span>
    <span class="c1"># with a default. This allows you to easily change</span>
    <span class="c1"># some hyper-parameter without redefining the whole </span>
    <span class="c1"># flax module.</span>
    <span class="n">alpha</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
            
    <span class="nd">@nn</span><span class="o">.</span><span class="n">compact</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>

        <span class="c1"># here we construct the first dense layer using a</span>
        <span class="c1"># pre-built implementation in flax.</span>
        <span class="c1"># features is the number of output nodes</span>
        <span class="c1"># WARNING: Won&#39;t work with complex hamiltonians because</span>
        <span class="c1"># of a bug in flax. Use nk.nn.Dense otherwise. </span>
        <span class="n">dense</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">*</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        
        <span class="c1"># we apply the dense layer to the input</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">dense</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="c1"># the non-linearity is a simple ReLu</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
                
        <span class="c1"># sum the output</span>
        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    
<span class="n">model</span> <span class="o">=</span> <span class="n">FFN</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">vstate</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">vqs</span><span class="o">.</span><span class="n">MCState</span><span class="p">(</span><span class="n">sampler</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="mi">1008</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><em>Warning</em>: Flax has a bug with its layers, where they drop the imaginary part
of complex numbers if the layer has real weights.
This is not a problem in the above example, but if you try to work on more complex
problems where you work with complex numbers you should rather use the equivalent
<code class="docutils literal notranslate"><span class="pre">nk.nn.Dense</span></code> which contains a fix for this bug.</p>
<p>We then proceed to the optimization as before.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">Sgd</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># Notice the use, again of Stochastic Reconfiguration, which considerably improves the optimisation</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">VMC</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">variational_state</span><span class="o">=</span><span class="n">vstate</span><span class="p">,</span><span class="n">preconditioner</span><span class="o">=</span><span class="n">nk</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="n">diag_shift</span><span class="o">=</span><span class="mf">0.1</span><span class="p">))</span>

<span class="n">log</span><span class="o">=</span><span class="n">nk</span><span class="o">.</span><span class="n">logging</span><span class="o">.</span><span class="n">RuntimeLog</span><span class="p">()</span>
<span class="n">gs</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">n_iter</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="n">out</span><span class="o">=</span><span class="n">log</span><span class="p">)</span>

<span class="n">ffn_energy</span><span class="o">=</span><span class="n">vstate</span><span class="o">.</span><span class="n">expect</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="n">error</span><span class="o">=</span><span class="nb">abs</span><span class="p">((</span><span class="n">ffn_energy</span><span class="o">.</span><span class="n">mean</span><span class="o">-</span><span class="n">eig_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">eig_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimized energy and relative error: &quot;</span><span class="p">,</span><span class="n">ffn_energy</span><span class="p">,</span><span class="n">error</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 300/300 [00:05&lt;00:00, 56.59it/s, Energy=-25.467 Â± 0.010 [ÏƒÂ²=0.103, RÌ‚=1.0014]]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimized energy and relative error:  -25.466 Â± 0.011 [ÏƒÂ²=0.123, RÌ‚=0.9995] 0.0009745407694233003
</pre></div>
</div>
</div>
</div>
<p>And we can compare the results between the two different ansatze:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_FFN</span> <span class="o">=</span> <span class="n">log</span><span class="o">.</span><span class="n">data</span>

<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">data_jastrow</span><span class="p">[</span><span class="s2">&quot;Energy&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iters</span><span class="p">,</span> <span class="n">data_jastrow</span><span class="p">[</span><span class="s2">&quot;Energy&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">Mean</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">data_jastrow</span><span class="p">[</span><span class="s2">&quot;Energy&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">Sigma</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Jastrow&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">data_FFN</span><span class="p">[</span><span class="s2">&quot;Energy&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iters</span><span class="p">,</span> <span class="n">data_FFN</span><span class="p">[</span><span class="s2">&quot;Energy&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">Mean</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">data_FFN</span><span class="p">[</span><span class="s2">&quot;Energy&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">Sigma</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;FFN&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">([</span><span class="n">E_gs</span><span class="p">],</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Exact&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Iterations&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Energy&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;Energy&#39;)
</pre></div>
</div>
<img alt="../_images/gs-ising_58_1.png" src="../_images/gs-ising_58_1.png" />
</div>
</div>
</div>
<div class="section" id="translation-symmetry">
<h2>7. Translation Symmetry<a class="headerlink" href="#translation-symmetry" title="Permalink to this headline">ïƒ</a></h2>
<p>In order to enforce spatial symmetries we can use some built-in functionalities of NetKet, in conjunction with equivariant layers.</p>
<p>The first step is to construct explicitly a graph that contains the edges of our interactions, in this case this is a simple chain with periodic boundaries. NetKet has builtin several symmetry groups that can be used to target specific spatial symmetries. In this case for example after constructing the graph we can also print its translation group.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">graph</span><span class="o">=</span><span class="n">nk</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">Chain</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">pbc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">graph</span><span class="o">.</span><span class="n">translation_group</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PermutationGroup(elems=[Id(), Translation([1]), Translation([2]), Translation([3]), Translation([4]), Translation([5]), Translation([6]), Translation([7]), Translation([8]), Translation([9]), Translation([10]), Translation([11]), Translation([12]), Translation([13]), Translation([14]), Translation([15]), Translation([16]), Translation([17]), Translation([18]), Translation([19])], degree=20)
</pre></div>
</div>
</div>
</div>
<p>Graphs are in general quite handy when defining hamiltonian terms on their edges. For example we can define our Hamiltonian as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Gamma</span><span class="o">=-</span><span class="mi">1</span>
<span class="n">H</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">Gamma</span><span class="o">*</span><span class="n">sigmax</span><span class="p">(</span><span class="n">hi</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)])</span>

<span class="n">V</span><span class="o">=-</span><span class="mi">1</span>
<span class="n">H</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">V</span><span class="o">*</span><span class="n">sigmaz</span><span class="p">(</span><span class="n">hi</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">sigmaz</span><span class="p">(</span><span class="n">hi</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">()])</span>
</pre></div>
</div>
</div>
</div>
<p>We now write a model with an invariant transformation given by the translation group. Notice that we will now use NetKetâ€™s own <code class="docutils literal notranslate"><span class="pre">nn</span></code> module, instead of Flax, since it contains several additions and also an extended and seamless support for complex layers/parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">netket.nn</span> <span class="k">as</span> <span class="nn">nknn</span>

<span class="k">class</span> <span class="nc">SymmModel</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="nb">int</span>

    <span class="nd">@nn</span><span class="o">.</span><span class="n">compact</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="c1"># add an extra dimension with size 1, because DenseSymm requires rank-3 tensors as inputs.</span>
        <span class="c1"># the shape will now be (batches, 1, Nsites)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="n">nknn</span><span class="o">.</span><span class="n">DenseSymm</span><span class="p">(</span><span class="n">symmetries</span><span class="o">=</span><span class="n">graph</span><span class="o">.</span><span class="n">translation_group</span><span class="p">(),</span>
                           <span class="n">features</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span>
                           <span class="n">kernel_init</span><span class="o">=</span><span class="n">nn</span><span class="o">.</span><span class="n">initializers</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">stddev</span><span class="o">=</span><span class="mf">0.01</span><span class="p">))(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="c1"># sum the output</span>
        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>


<span class="n">sampler</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="n">MetropolisLocal</span><span class="p">(</span><span class="n">hi</span><span class="p">)</span>

<span class="c1">#Let us define a model with 4 features per symmetry</span>
<span class="n">model</span><span class="o">=</span><span class="n">SymmModel</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">vstate</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">vqs</span><span class="o">.</span><span class="n">MCState</span><span class="p">(</span><span class="n">sampler</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="mi">1008</span><span class="p">)</span>

<span class="n">vstate</span><span class="o">.</span><span class="n">n_parameters</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>84
</pre></div>
</div>
</div>
</div>
<p>As it can be seen, the number of parameters of this model is greatly reduced, because of the symmetries that impose constraints on the weights of the dense layers. We can now optimize the model, using a few more optimization steps than before.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">Sgd</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="n">gs</span> <span class="o">=</span> <span class="n">nk</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">VMC</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">variational_state</span><span class="o">=</span><span class="n">vstate</span><span class="p">,</span><span class="n">preconditioner</span><span class="o">=</span><span class="n">nk</span><span class="o">.</span><span class="n">optimizer</span><span class="o">.</span><span class="n">SR</span><span class="p">(</span><span class="n">diag_shift</span><span class="o">=</span><span class="mf">0.1</span><span class="p">))</span>

<span class="n">log</span><span class="o">=</span><span class="n">nk</span><span class="o">.</span><span class="n">logging</span><span class="o">.</span><span class="n">RuntimeLog</span><span class="p">()</span>
<span class="n">gs</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">n_iter</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span><span class="n">out</span><span class="o">=</span><span class="n">log</span><span class="p">)</span>

<span class="n">symm_energy</span><span class="o">=</span><span class="n">vstate</span><span class="o">.</span><span class="n">expect</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="n">error</span><span class="o">=</span><span class="nb">abs</span><span class="p">((</span><span class="n">symm_energy</span><span class="o">.</span><span class="n">mean</span><span class="o">-</span><span class="n">eig_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="n">eig_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Optimized energy and relative error: &quot;</span><span class="p">,</span><span class="n">symm_energy</span><span class="p">,</span><span class="n">error</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 600/600 [00:37&lt;00:00, 15.91it/s, Energy=-25.4851 Â± 0.0040 [ÏƒÂ²=0.0161, RÌ‚=1.0041]]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimized energy and relative error:  -25.4726 Â± 0.0042 [ÏƒÂ²=0.0181, RÌ‚=1.0015] 0.000721730754115699
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Energy&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iters</span><span class="p">[</span><span class="mi">50</span><span class="p">:],</span><span class="n">log</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Energy&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">Mean</span><span class="p">[</span><span class="mi">50</span><span class="p">:],</span><span class="n">yerr</span><span class="o">=</span><span class="n">log</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Energy&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">Sigma</span><span class="p">[</span><span class="mi">50</span><span class="p">:],</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;SymmModel&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">eig_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xmax</span><span class="o">=</span><span class="n">log</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Energy&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">iters</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Exact&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Iterations&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Energy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f13e0593400&gt;
</pre></div>
</div>
<img alt="../_images/gs-ising_67_1.png" src="../_images/gs-ising_67_1.png" />
</div>
</div>
</div>
<div class="section" id="measuring-other-properties">
<h2>8. Measuring Other Properties<a class="headerlink" href="#measuring-other-properties" title="Permalink to this headline">ïƒ</a></h2>
<p>Once the model has been optimized, we can of course measure also other observables that are not the energy. For example, we could decide to measure the value of the nearest-neighbor <span class="math notranslate nohighlight">\(X-X\)</span> correlator.
Notice that since correlators do not enjoy the zero-variance principle as the Hamiltonian instead does, it is important to use a larger number of samples to have a sufficiently low error bar on their measurement.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corr</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">sigmax</span><span class="p">(</span><span class="n">hi</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">sigmax</span><span class="p">(</span><span class="n">hi</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">()])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vstate</span><span class="o">.</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">400000</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vstate</span><span class="o">.</span><span class="n">expect</span><span class="p">(</span><span class="n">corr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>11.136 Â± 0.017 [ÏƒÂ²=30.810, RÌ‚=1.0001]
</pre></div>
</div>
</div>
</div>
<p>And we can further compare this to the exact ED result.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">psi</span> <span class="o">=</span> <span class="n">eig_vecs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">exact_corr</span><span class="o">=</span><span class="n">psi</span><span class="o">@</span><span class="p">(</span><span class="n">corr</span><span class="nd">@psi</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">exact_corr</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10.852248713127903
</pre></div>
</div>
</div>
</div>
</div>
</div>


              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Giuseppe Carleo et al.<br/>
    
        &copy; Copyright 2019-2021, The Netket authors - All rights reserved.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>