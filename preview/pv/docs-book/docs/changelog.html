
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Change Log &#8212; NetKet</title>
    
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    
  <link href="../_static/styles/sphinx-book-theme.css?digest=da817022793a90a681ee" rel="stylesheet">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="The Lindblad Master Equation" href="superop.html" />
    <link rel="prev" title="Symmetries: Honeycomb Heisenberg model" href="../tutorials/G-CNN_Honeycomb.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
<!-- An invisible pixel that we watch to see if we've scrolled. -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint">
<!-- NAVBAR From boostrap 4.5 and old netket -->
  <nav class="navbar navbar-custom navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
      <a class="navbar-brand navbar-custom-brand" href="../index.html">
                <span>
                  <img src="../_static/logonav.png" width="50" height="50" class="navbar-custom-logo d-inline-block align-center" alt="" loading="lazy">
                </span>
            NetKet</a>
      <span class="navbar-text navbar-version pull-left"><b></b></span>

      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
          <!-- Active class kept here for posterity
          <li class="nav-item active">
            <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
          </li>
          -->
          
              <li class="nav-item">
                <a class="nav-link" href="../getting_started.html">Get Started</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="../citing.html">Citing NetKet</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="../about.html">About</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="../index.html">Documentation</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="../api/api.html">API Reference</a>
              </li>
          
        </ul>
        <ul class="navbar-nav ml-auto">
          
              <li class="nav-item">
                <a class="nav-link" href="https://github.com/netket/netket"><i class="fab fa-github" aria-hidden="true"></i></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="https://twitter.com/NetKetOrg"><i class="fab fa-twitter" aria-hidden="true"></i></a>
              </li>
          
          
            <li class="nav-item">
              <a class="btn btn-outline-warning btn-download" href="../docs2/install.html">Install</a>
            </li>
          
        </ul>
      </div>
    </div>
  </nav>
<!-- /end NAVBAR From boostrap 4.5 and old netket --></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="pl-4 pr-3 bd-sidebar site-navigation noprint " id="site-navigation">
    <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo_simple.jpg" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../docs2/install.html">
   Installation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tutorials
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/j1j2.html">
   Ground-State: J1-J2 model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../tutorials/G-CNN_Honeycomb.html">
   Symmetries: Honeycomb Heisenberg model
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Reference Documentation
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Change Log
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="superop.html">
   The Lindblad Master Equation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hilbert.html">
   The Hilbert module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="operator.html">
   The Operator module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="varstate.html">
   The Variational State Interface
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sr.html">
   Quantum Geometric Tensor and Stochastic Reconfiguration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="drivers.html">
   The Drivers API
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sharp-bits.html">
   ðŸ”ª The Sharp Bits ðŸ”ª
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  API documentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="api-stability.html">
   API Stability
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../api/api.html">
   Public API
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/graph.html">
     netket.graph
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.AbstractGraph.html">
       netket.graph.AbstractGraph
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Graph.html">
       netket.graph.Graph
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Lattice.html">
       netket.graph.Lattice
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Edgeless.html">
       netket.graph.Edgeless
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Hypercube.html">
       netket.graph.Hypercube
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.lattice.LatticeSite.html">
       netket.graph.lattice.LatticeSite
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Grid.html">
       netket.graph.Grid
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Diamond.html">
       netket.graph.Diamond
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Kagome.html">
       netket.graph.Kagome
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Square.html">
       netket.graph.Square
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Chain.html">
       netket.graph.Chain
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Cube.html">
       netket.graph.Cube
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.BCC.html">
       netket.graph.BCC
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.FCC.html">
       netket.graph.FCC
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Honeycomb.html">
       netket.graph.Honeycomb
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.KitaevHoneycomb.html">
       netket.graph.KitaevHoneycomb
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Triangular.html">
       netket.graph.Triangular
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.Pyrochlore.html">
       netket.graph.Pyrochlore
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.DoubledGraph.html">
       netket.graph.DoubledGraph
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/graph/netket.graph.disjoint_union.html">
       netket.graph.disjoint_union
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/hilbert.html">
     netket.hilbert
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.AbstractHilbert.html">
       netket.hilbert.AbstractHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.ContinuousHilbert.html">
       netket.hilbert.ContinuousHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.DiscreteHilbert.html">
       netket.hilbert.DiscreteHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.HomogeneousHilbert.html">
       netket.hilbert.HomogeneousHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.CustomHilbert.html">
       netket.hilbert.CustomHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.TensorHilbert.html">
       netket.hilbert.TensorHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.DoubledHilbert.html">
       netket.hilbert.DoubledHilbert
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.Spin.html">
       netket.hilbert.Spin
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.Qubit.html">
       netket.hilbert.Qubit
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.Fock.html">
       netket.hilbert.Fock
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.Particle.html">
       netket.hilbert.Particle
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/operator.html">
     netket.operator
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
    <label for="toctree-checkbox-4">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.AbstractOperator.html">
       netket.operator.AbstractOperator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.AbstractSuperOperator.html">
       netket.operator.AbstractSuperOperator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.DiscreteOperator.html">
       netket.operator.DiscreteOperator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.BoseHubbard.html">
       netket.operator.BoseHubbard
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.GraphOperator.html">
       netket.operator.GraphOperator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.LocalOperator.html">
       netket.operator.LocalOperator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.Ising.html">
       netket.operator.Ising
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.Heisenberg.html">
       netket.operator.Heisenberg
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.PauliStrings.html">
       netket.operator.PauliStrings
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.LocalLiouvillian.html">
       netket.operator.LocalLiouvillian
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.boson.create.html">
       netket.operator.boson.create
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.boson.destroy.html">
       netket.operator.boson.destroy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.boson.number.html">
       netket.operator.boson.number
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.boson.proj.html">
       netket.operator.boson.proj
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.spin.sigmax.html">
       netket.operator.spin.sigmax
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.spin.sigmay.html">
       netket.operator.spin.sigmay
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.spin.sigmaz.html">
       netket.operator.spin.sigmaz
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.spin.sigmap.html">
       netket.operator.spin.sigmap
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.spin.sigmam.html">
       netket.operator.spin.sigmam
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.ContinuousOperator.html">
       netket.operator.ContinuousOperator
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.KineticEnergy.html">
       netket.operator.KineticEnergy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.PotentialEnergy.html">
       netket.operator.PotentialEnergy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/operator/netket.operator.SumOperator.html">
       netket.operator.SumOperator
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/exact.html">
     netket.exact
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
    <label for="toctree-checkbox-5">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/exact/netket.exact.full_ed.html">
       netket.exact.full_ed
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/exact/netket.exact.lanczos_ed.html">
       netket.exact.lanczos_ed
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/exact/netket.exact.steady_state.html">
       netket.exact.steady_state
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/sampler.html">
     netket.sampler
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.Sampler.html">
       netket.sampler.Sampler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.SamplerState.html">
       netket.sampler.SamplerState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisSamplerState.html">
       netket.sampler.MetropolisSamplerState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisRule.html">
       netket.sampler.MetropolisRule
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.ExactSampler.html">
       netket.sampler.ExactSampler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisSampler.html">
       netket.sampler.MetropolisSampler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisSamplerNumpy.html">
       netket.sampler.MetropolisSamplerNumpy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.ARDirectSampler.html">
       netket.sampler.ARDirectSampler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisLocal.html">
       netket.sampler.MetropolisLocal
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisExchange.html">
       netket.sampler.MetropolisExchange
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisHamiltonian.html">
       netket.sampler.MetropolisHamiltonian
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisRule.html">
       netket.sampler.MetropolisRule
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.rules.LocalRule.html">
       netket.sampler.rules.LocalRule
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.rules.ExchangeRule.html">
       netket.sampler.rules.ExchangeRule
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.rules.HamiltonianRule.html">
       netket.sampler.rules.HamiltonianRule
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.rules.HamiltonianRuleNumpy.html">
       netket.sampler.rules.HamiltonianRuleNumpy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.rules.CustomRuleNumpy.html">
       netket.sampler.rules.CustomRuleNumpy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.SamplerState.html">
       netket.sampler.SamplerState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/samplers/netket.sampler.MetropolisSamplerState.html">
       netket.sampler.MetropolisSamplerState
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/models.html">
     netket.models
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.RBM.html">
       netket.models.RBM
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.RBMModPhase.html">
       netket.models.RBMModPhase
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.RBMMultiVal.html">
       netket.models.RBMMultiVal
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.RBMSymm.html">
       netket.models.RBMSymm
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.Jastrow.html">
       netket.models.Jastrow
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.MPSPeriodic.html">
       netket.models.MPSPeriodic
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.NDM.html">
       netket.models.NDM
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.GCNN.html">
       netket.models.GCNN
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.AbstractARNN.html">
       netket.models.AbstractARNN
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.ARNNDense.html">
       netket.models.ARNNDense
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.ARNNConv1D.html">
       netket.models.ARNNConv1D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.ARNNConv2D.html">
       netket.models.ARNNConv2D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.FastARNNConv1D.html">
       netket.models.FastARNNConv1D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/models/netket.models.FastARNNConv2D.html">
       netket.models.FastARNNConv2D
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/nn.html">
     netket.nn
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.Dense.html">
       netket.nn.Dense
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.DenseGeneral.html">
       netket.nn.DenseGeneral
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.DenseSymm.html">
       netket.nn.DenseSymm
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.DenseEquivariant.html">
       netket.nn.DenseEquivariant
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.Conv.html">
       netket.nn.Conv
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.Embed.html">
       netket.nn.Embed
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.MaskedDense1D.html">
       netket.nn.MaskedDense1D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.MaskedConv1D.html">
       netket.nn.MaskedConv1D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.MaskedConv2D.html">
       netket.nn.MaskedConv2D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.celu.html">
       netket.nn.celu
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.elu.html">
       netket.nn.elu
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.gelu.html">
       netket.nn.gelu
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.glu.html">
       netket.nn.glu
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.log_sigmoid.html">
       netket.nn.log_sigmoid
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.log_softmax.html">
       netket.nn.log_softmax
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.relu.html">
       netket.nn.relu
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.sigmoid.html">
       netket.nn.sigmoid
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.soft_sign.html">
       netket.nn.soft_sign
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.softmax.html">
       netket.nn.softmax
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.softplus.html">
       netket.nn.softplus
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.swish.html">
       netket.nn.swish
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.log_cosh.html">
       netket.nn.log_cosh
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.reim_relu.html">
       netket.nn.reim_relu
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/nn/netket.nn.reim_selu.html">
       netket.nn.reim_selu
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/jax.html">
     netket.jax
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.HashablePartial.html">
       netket.jax.HashablePartial
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.PRNGKey.html">
       netket.jax.PRNGKey
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.PRNGSeq.html">
       netket.jax.PRNGSeq
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.mpi_split.html">
       netket.jax.mpi_split
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_dot.html">
       netket.jax.tree_dot
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_axpy.html">
       netket.jax.tree_axpy
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_cast.html">
       netket.jax.tree_cast
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_conj.html">
       netket.jax.tree_conj
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_size.html">
       netket.jax.tree_size
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_leaf_iscomplex.html">
       netket.jax.tree_leaf_iscomplex
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_ishomogeneous.html">
       netket.jax.tree_ishomogeneous
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_ravel.html">
       netket.jax.tree_ravel
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.tree_to_real.html">
       netket.jax.tree_to_real
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.dtype_complex.html">
       netket.jax.dtype_complex
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.is_complex.html">
       netket.jax.is_complex
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.is_complex_dtype.html">
       netket.jax.is_complex_dtype
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.maybe_promote_to_complex.html">
       netket.jax.maybe_promote_to_complex
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.expect.html">
       netket.jax.expect
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.vjp.html">
       netket.jax.vjp
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.chunk.html">
       netket.jax.chunk
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.unchunk.html">
       netket.jax.unchunk
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.vjp_chunked.html">
       netket.jax.vjp_chunked
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/jax/netket.jax.vmap_chunked.html">
       netket.jax.vmap_chunked
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/vqs.html">
     netket.vqs
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
    <label for="toctree-checkbox-10">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/vqs/netket.vqs.VariationalState.html">
       netket.vqs.VariationalState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/vqs/netket.vqs.ExactState.html">
       netket.vqs.ExactState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/vqs/netket.vqs.MCState.html">
       netket.vqs.MCState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/vqs/netket.vqs.MCMixedState.html">
       netket.vqs.MCMixedState
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/vqs/netket.vqs.get_local_kernel.html">
       netket.vqs.get_local_kernel
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/vqs/netket.vqs.get_local_kernel_arguments.html">
       netket.vqs.get_local_kernel_arguments
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/optimizer.html">
     netket.optimizer
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
    <label for="toctree-checkbox-11">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.Adam.html">
       netket.optimizer.Adam
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.AdaGrad.html">
       netket.optimizer.AdaGrad
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.Sgd.html">
       netket.optimizer.Sgd
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.Momentum.html">
       netket.optimizer.Momentum
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.RmsProp.html">
       netket.optimizer.RmsProp
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.SR.html">
       netket.optimizer.SR
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.qgt.QGTAuto.html">
       netket.optimizer.qgt.QGTAuto
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.qgt.QGTOnTheFly.html">
       netket.optimizer.qgt.QGTOnTheFly
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.qgt.QGTJacobianPyTree.html">
       netket.optimizer.qgt.QGTJacobianPyTree
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.qgt.QGTJacobianDense.html">
       netket.optimizer.qgt.QGTJacobianDense
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.solver.svd.html">
       netket.optimizer.solver.svd
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.solver.cholesky.html">
       netket.optimizer.solver.cholesky
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.solver.LU.html">
       netket.optimizer.solver.LU
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/optim/netket.optimizer.solver.solve.html">
       netket.optimizer.solver.solve
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/logging.html">
     netket.logging
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
    <label for="toctree-checkbox-12">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/driver/netket.logging.RuntimeLog.html">
       netket.logging.RuntimeLog
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/driver/netket.logging.JsonLog.html">
       netket.logging.JsonLog
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/driver/netket.logging.StateLog.html">
       netket.logging.StateLog
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/driver/netket.logging.TensorBoardLog.html">
       netket.logging.TensorBoardLog
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/callbacks.html">
     netket.callbacks
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
    <label for="toctree-checkbox-13">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/callbacks/netket.callbacks.EarlyStopping.html">
       netket.callbacks.EarlyStopping
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/callbacks/netket.callbacks.Timeout.html">
       netket.callbacks.Timeout
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../api/utils.html">
     netket.utils
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
    <label for="toctree-checkbox-14">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/utils/netket.utils.HashableArray.html">
       netket.utils.HashableArray
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/utils/netket.utils.mpi.available.html">
       netket.utils.mpi.available
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/utils/netket.utils.mpi.n_nodes.html">
       netket.utils.mpi.n_nodes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/utils/netket.utils.mpi.rank.html">
       netket.utils.mpi.rank
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/utils/netket.utils.mpi.MPI_jax_comm.html">
       netket.utils.mpi.MPI_jax_comm
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../api/_generated/utils/netket.utils.mpi.MPI_py_comm.html">
       netket.utils.mpi.MPI_py_comm
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="api-experimental.html">
   Experimental API
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/experimental/samplers/netket.experimental.sampler.MetropolisPtSampler.html">
     netket.experimental.sampler.MetropolisPtSampler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/experimental/samplers/netket.experimental.sampler.MetropolisLocalPt.html">
     netket.experimental.sampler.MetropolisLocalPt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/experimental/samplers/netket.experimental.sampler.MetropolisExchangePt.html">
     netket.experimental.sampler.MetropolisExchangePt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/experimental/samplers/netket.experimental.sampler.MetropolisSamplerPmap.html">
     netket.experimental.sampler.MetropolisSamplerPmap
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/experimental/variational/netket.experimental.vqs.variables_from_file.html">
     netket.experimental.vqs.variables_from_file
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/experimental/variational/netket.experimental.vqs.variables_from_tar.html">
     netket.experimental.vqs.variables_from_tar
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="_generated/experimental/dynamics/netket.experimental.driver.TDVP.html">
     netket.experimental.driver.TDVP
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Developer Documentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="contributing.html">
   Contributing to NetKet
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="writing-tests.html">
   Writing Tests
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        


<div class="col py-1 d-flex topbar-main">
    <div class="topbar-left">
        
        <label class="nav-toggle-button topbarbtn" for="__navigation">
            <div class="visually-hidden">Toggle navigation</div>
            <i class="fas fa-bars"></i>
        </label>
        
    </div>
    <div class="topbar-right">
        <!-- Launch buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/netket/netket"><button type="button" class="topbarbtn--wide"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/netket/netket/issues/new?title=Issue%20on%20page%20%2Fdocs/changelog.html&body=Your%20issue%20content%20here."><button
                type="button" class="topbarbtn--wide" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

        
<div class="dropdown-buttons-trigger sb-download-buttons">
    <button id="dropdown-buttons-trigger" class="topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/docs/changelog.md.txt"><button type="button"
                class="topbarbtn--wide" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="topbarbtn--wide" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <label class="d-block d-md-none nav-toggle-button topbarbtn" for="__page-toc">
  <div class="visually-hidden">Toggle Table of Contents</div>
  <i class="fas fa-list"></i>
</label>
    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#netket-3-4-in-development">
   NetKet 3.4 (âš™ï¸ In development)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#new-features">
     New features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#breaking-changes">
     Breaking Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#internal-changes">
     Internal Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bug-fixes">
     Bug Fixes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#netket-3-3-2-bug-fixes">
   NetKet 3.3.2 (ðŸ› Bug Fixes)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Internal Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Bug Fixes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#netket-3-3-1-bug-fixes">
   NetKet 3.3.1 (ðŸ› Bug Fixes)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#netket-3-3-20-december-2021">
   NetKet 3.3 (ðŸŽ 20 December 2021)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     New features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     Breaking Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#deprecations">
     Deprecations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     Internal Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     Bug Fixes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#netket-3-2-26-november-2021">
   NetKet 3.2 (26 November 2021)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     New features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     Breaking Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     Bug Fixes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#netket-3-1-20-october-2021">
   NetKet 3.1 (20 October 2021)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id10">
     New features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     Breaking Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id12">
     Internal Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id13">
     Bug Fixes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#netket-3-0-23-august-2021">
   NetKet 3.0 (23 august 2021)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id14">
     New features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id15">
     Breaking Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id16">
     Internal Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id17">
     Bug Fixes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#netket-3-0b4-17-august-2021">
   NetKet 3.0b4 (17 august 2021)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id18">
     New features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id19">
     Breaking Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id20">
     Internal Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id21">
     Bug Fixes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#netket-3-0b3-published-on-9-july-2021">
   NetKet 3.0b3 (published on 9 july 2021)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id22">
     New features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id23">
     Breaking Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id24">
     Internal Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id25">
     Bug Fixes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#netket-3-0b2-published-on-31-may-2021">
   NetKet 3.0b2 (published on 31 May 2021)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id26">
     New features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id27">
     Breaking Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id28">
     Bug Fixes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#netket-3-0b1-published-beta-release">
   NetKet 3.0b1 (published beta release)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#api-changes">
     API Changes
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Change Log</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#netket-3-4-in-development">
   NetKet 3.4 (âš™ï¸ In development)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#new-features">
     New features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#breaking-changes">
     Breaking Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#internal-changes">
     Internal Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bug-fixes">
     Bug Fixes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#netket-3-3-2-bug-fixes">
   NetKet 3.3.2 (ðŸ› Bug Fixes)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Internal Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Bug Fixes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#netket-3-3-1-bug-fixes">
   NetKet 3.3.1 (ðŸ› Bug Fixes)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#netket-3-3-20-december-2021">
   NetKet 3.3 (ðŸŽ 20 December 2021)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     New features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     Breaking Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#deprecations">
     Deprecations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     Internal Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     Bug Fixes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#netket-3-2-26-november-2021">
   NetKet 3.2 (26 November 2021)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     New features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     Breaking Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id9">
     Bug Fixes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#netket-3-1-20-october-2021">
   NetKet 3.1 (20 October 2021)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id10">
     New features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     Breaking Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id12">
     Internal Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id13">
     Bug Fixes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#netket-3-0-23-august-2021">
   NetKet 3.0 (23 august 2021)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id14">
     New features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id15">
     Breaking Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id16">
     Internal Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id17">
     Bug Fixes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#netket-3-0b4-17-august-2021">
   NetKet 3.0b4 (17 august 2021)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id18">
     New features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id19">
     Breaking Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id20">
     Internal Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id21">
     Bug Fixes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#netket-3-0b3-published-on-9-july-2021">
   NetKet 3.0b3 (published on 9 july 2021)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id22">
     New features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id23">
     Breaking Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id24">
     Internal Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id25">
     Bug Fixes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#netket-3-0b2-published-on-31-may-2021">
   NetKet 3.0b2 (published on 31 May 2021)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id26">
     New features
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id27">
     Breaking Changes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id28">
     Bug Fixes
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#netket-3-0b1-published-beta-release">
   NetKet 3.0b1 (published beta release)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#api-changes">
     API Changes
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="change-log">
<h1>Change Log<a class="headerlink" href="#change-log" title="Permalink to this headline">Â¶</a></h1>
<section id="netket-3-4-in-development">
<h2>NetKet 3.4 (âš™ï¸ In development)<a class="headerlink" href="#netket-3-4-in-development" title="Permalink to this headline">Â¶</a></h2>
<p><a class="reference external" href="https://github.com/netket/netket/compare/v3.3...master">GitHub commits</a>.</p>
<section id="new-features">
<h3>New features<a class="headerlink" href="#new-features" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Lattice</span></code> supports specifying arbitrary edge content for each unit cell via the kwarg <code class="docutils literal notranslate"><span class="pre">custom_edges</span></code>. A generator for hexagonal lattices with coloured edges is implemented as <code class="docutils literal notranslate"><span class="pre">nk.graph.KitaevHoneycomb</span></code>. <code class="docutils literal notranslate"><span class="pre">nk.graph.Grid</span></code> again supports colouring edges by direction. <a class="reference external" href="https://github.com/netket/netket/pull/1074">#1074</a></p></li>
</ul>
</section>
<section id="breaking-changes">
<h3>Breaking Changes<a class="headerlink" href="#breaking-changes" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>The gradient for models with real-parameter is now multiplied by 2. If your model had real parameters you might need to change the learning rate and halve it. Conceptually this is a bug-fix, as the value returned before was wrong (see Bug Fixes section below for additional details) <a class="reference external" href="https://github.com/netket/netket/pull/1069">#1069</a></p></li>
</ul>
</section>
<section id="internal-changes">
<h3>Internal Changes<a class="headerlink" href="#internal-changes" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="bug-fixes">
<h3>Bug Fixes<a class="headerlink" href="#bug-fixes" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>The gradient obtained with <code class="docutils literal notranslate"><span class="pre">VarState.expect_and_grad</span></code> for models with real-parameters was off by a factor of <span class="math notranslate nohighlight">\( 1/2 \)</span> from the correct value. This has now been corrected. As a consequence, the correct gradient for real-parameter models is equal to the old times 2. If your model had real parameters you might need to change the learning rate and halve it. <a class="reference external" href="https://github.com/netket/netket/pull/1069">#1069</a></p></li>
<li><p>Support for coloured edges in <code class="docutils literal notranslate"><span class="pre">nk.graph.Grid</span></code>, removed in <a class="reference external" href="https://github.com/netket/netket/pull/724">#724</a>, is now restored. <a class="reference external" href="https://github.com/netket/netket/pull/1074">#1074</a></p></li>
</ul>
</section>
</section>
<section id="netket-3-3-2-bug-fixes">
<h2>NetKet 3.3.2 (ðŸ› Bug Fixes)<a class="headerlink" href="#netket-3-3-2-bug-fixes" title="Permalink to this headline">Â¶</a></h2>
<section id="id1">
<h3>Internal Changes<a class="headerlink" href="#id1" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>Support for Python 3.10 <a class="reference external" href="https://github.com/netket/netket/pull/952">#952</a>.</p></li>
<li><p>The minimum <a class="reference external" href="https://github.com/deepmind/optax">optax</a> version is now <code class="docutils literal notranslate"><span class="pre">0.1.1</span></code>, which finally correctly supports complex numbers. The internal implementation of Adam which was introduced in 3.3 (<a class="reference external" href="https://github.com/netket/netket/pull/1069">#1069</a>) has been removed. If an older version of <code class="docutils literal notranslate"><span class="pre">optax</span></code> is detected, an import error is thrown to avoid providing wrong numerical results. Please update your optax version! <a class="reference external" href="https://github.com/netket/netket/pull/1097">#1097</a></p></li>
</ul>
</section>
<section id="id2">
<h3>Bug Fixes<a class="headerlink" href="#id2" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>Allow <code class="docutils literal notranslate"><span class="pre">LazyOperator&#64;densevector</span></code> for operators such as lazy <code class="docutils literal notranslate"><span class="pre">Adjoint</span></code>, <code class="docutils literal notranslate"><span class="pre">Transpose</span></code> and <code class="docutils literal notranslate"><span class="pre">Squared</span></code>. <a class="reference external" href="https://github.com/netket/netket/pull/1068">#1068</a></p></li>
<li><p>The logic to update the progress bar in <code class="docutils literal notranslate"><span class="pre">nk.experimental.TDVP</span></code> has been improved, and it should now display updates even if there are very sparse <code class="docutils literal notranslate"><span class="pre">save_steps</span></code>. <a class="reference external" href="https://github.com/netket/netket/pull/1084">#1084</a></p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">nk.logging.TensorBoardLog</span></code> is now lazily initialized to better work in an MPI environment. <a class="reference external" href="https://github.com/netket/netket/pull/1086">#1086</a></p></li>
<li><p>Converting a <code class="docutils literal notranslate"><span class="pre">nk.operator.BoseHubbard</span></code> to a <code class="docutils literal notranslate"><span class="pre">nk.operator.LocalOperator</span></code> multiplied by 2 the nonlinearity <code class="docutils literal notranslate"><span class="pre">U</span></code>. This has now been fixed. <a class="reference external" href="https://github.com/netket/netket/pull/1102">#1102</a></p></li>
</ul>
</section>
</section>
<section id="netket-3-3-1-bug-fixes">
<h2>NetKet 3.3.1 (ðŸ› Bug Fixes)<a class="headerlink" href="#netket-3-3-1-bug-fixes" title="Permalink to this headline">Â¶</a></h2>
<p><a class="reference external" href="https://github.com/netket/netket/compare/v3.3...v3.3.1">GitHub commits</a>.</p>
<ul class="simple">
<li><p>Initialisation of all implementations of <code class="docutils literal notranslate"><span class="pre">DenseSymm</span></code>, <code class="docutils literal notranslate"><span class="pre">DenseEquivariant</span></code>, <code class="docutils literal notranslate"><span class="pre">GCNN</span></code> now defaults to truncated normals with Lecun variance scaling. For layers without masking, there should be no noticeable change in behaviour. For masked layers, the same variance scaling now works correctly. <a class="reference external" href="https://github.com/netket/netket/pull/1045">#1045</a></p></li>
<li><p>Fix bug that prevented gradients of non-hermitian operators to be computed. The feature is still marked as experimental but will now run (we do not guarantee that results are correct). <a class="reference external" href="https://github.com/netket/netket/pull/1053">#1053</a></p></li>
<li><p>Common lattice constructors such as <code class="docutils literal notranslate"><span class="pre">Honeycomb</span></code> now accepts the same keyword arguments as <code class="docutils literal notranslate"><span class="pre">Lattice</span></code>. <a class="reference external" href="https://github.com/netket/netket/pull/1046">#1046</a></p></li>
<li><p>Multiplying a <code class="docutils literal notranslate"><span class="pre">QGTOnTheFly</span></code> representing the real part of the QGT (showing up when the ansatz has real parameters) with a complex vector now throws an error. Previously the result would be wrong, as the imaginary part <a class="reference external" href="https://github.com/netket/netket/issues/789#issuecomment-871145119">was casted away</a>. <a class="reference external" href="https://github.com/netket/netket/pull/885">#885</a></p></li>
</ul>
</section>
<section id="netket-3-3-20-december-2021">
<h2>NetKet 3.3 (ðŸŽ 20 December 2021)<a class="headerlink" href="#netket-3-3-20-december-2021" title="Permalink to this headline">Â¶</a></h2>
<p><a class="reference external" href="https://github.com/netket/netket/compare/v3.2...v3.3">GitHub commits</a>.</p>
<section id="id3">
<h3>New features<a class="headerlink" href="#id3" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>The interface to define expectation and gradient function of arbitrary custom operators is now stable. If you want to define it for a standard operator that can be written as an average of local expectation terms, you can now define a dispatch rule for <span class="xref std std-ref">netket.vqs.get_local_kernel_arguments</span> and <span class="xref std std-ref">netket.vqs.get_local_kernel</span>. The old mechanism is still supported, but we encourage to use the new mechanism as it is more terse. <a class="reference external" href="https://github.com/netket/netket/pull/954">#954</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nk.optimizer.Adam</span></code> now supports complex parameters, and you can use <code class="docutils literal notranslate"><span class="pre">nk.optimizer.split_complex</span></code> to make optimizers process complex parameters as if they are pairs of real parameters. <a class="reference external" href="https://github.com/netket/netket/pull/1009">#1009</a></p></li>
<li><p>Chunking of <code class="docutils literal notranslate"><span class="pre">MCState.expect</span></code> and <code class="docutils literal notranslate"><span class="pre">MCState.expect_and_grad</span></code> computations is now supported, which allows to bound the memory cost in exchange of a minor increase in computation time. <a class="reference external" href="https://github.com/netket/netket/pull/1006">#1006</a> (and discussions in <a class="reference external" href="https://github.com/netket/netket/pull/918">#918</a> and <a class="reference external" href="https://github.com/netket/netket/pull/830">#830</a>)</p></li>
<li><p>A new variational state that performs exact summation over the whole Hilbert space has been added. It can be constructed with <span class="xref std std-ref">nk.vqs.ExactState</span> and supports the same Jax neural networks as <span class="xref std std-ref">nk.vqs.MCState</span>. <a class="reference external" href="https://github.com/netket/netket/pull/953">#953</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DenseSymm</span></code> allows multiple input features. <a class="reference external" href="https://github.com/netket/netket/pull/1030">#1030</a></p></li>
<li><p>[Experimental] A new time-evolution driver  <span class="xref std std-ref">nk.experimental.TDVP</span> using the time-dependent variational principle (TDVP) has been added. It works with time-independent and time-dependent Hamiltonians and Liouvillians. <a class="reference external" href="https://github.com/netket/netket/pull/1012">#1012</a></p></li>
<li><p>[Experimental] A set of JAX-compatible Runge-Kutta ODE integrators has been added for use together with the new TDVP driver. <a class="reference external" href="https://github.com/netket/netket/pull/1012">#1012</a></p></li>
</ul>
</section>
<section id="id4">
<h3>Breaking Changes<a class="headerlink" href="#id4" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>The method <code class="docutils literal notranslate"><span class="pre">sample_next</span></code> in <code class="docutils literal notranslate"><span class="pre">Sampler</span></code> and exact samplers (<code class="docutils literal notranslate"><span class="pre">ExactSampler</span></code> and <code class="docutils literal notranslate"><span class="pre">ARDirectSampler</span></code>) is removed, and it is only defined in <code class="docutils literal notranslate"><span class="pre">MetropolisSampler</span></code>. The module function <code class="docutils literal notranslate"><span class="pre">nk.sampler.sample_next</span></code> also only works with <code class="docutils literal notranslate"><span class="pre">MetropolisSampler</span></code>. For exact samplers, please use the method <code class="docutils literal notranslate"><span class="pre">sample</span></code> instead. <a class="reference external" href="https://github.com/netket/netket/pull/1016">#1016</a></p></li>
<li><p>The default value of <code class="docutils literal notranslate"><span class="pre">n_chains_per_rank</span></code> in <code class="docutils literal notranslate"><span class="pre">Sampler</span></code> and exact samplers is changed to 1, and specifying <code class="docutils literal notranslate"><span class="pre">n_chains</span></code> or <code class="docutils literal notranslate"><span class="pre">n_chains_per_rank</span></code> when constructing them is deprecated. Please change <code class="docutils literal notranslate"><span class="pre">chain_length</span></code> when calling <code class="docutils literal notranslate"><span class="pre">sample</span></code>. For <code class="docutils literal notranslate"><span class="pre">MetropolisSampler</span></code>, the default value is changed from <code class="docutils literal notranslate"><span class="pre">n_chains</span> <span class="pre">=</span> <span class="pre">16</span></code> (across all ranks) to <code class="docutils literal notranslate"><span class="pre">n_chains_per_rank</span> <span class="pre">=</span> <span class="pre">16</span></code>. <a class="reference external" href="https://github.com/netket/netket/pull/1017">#1017</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GCNN_Parity</span></code> allowed biasing both the parity-preserving and the parity-flip equivariant layers. These enter into the network output the same way, so having both is redundant and makes QGTs unstable. The biases of the parity-flip layers are now removed. The previous behaviour can be restored using the deprecated <code class="docutils literal notranslate"><span class="pre">extra_bias</span></code> switch; we only recommend this for loading previously saved parameters. Such parameters can be transformed to work with the new default using <code class="docutils literal notranslate"><span class="pre">nk.models.update_GCNN_parity</span></code>. <a class="reference external" href="https://github.com/netket/netket/pull/1030">#1030</a></p></li>
<li><p>Kernels of <code class="docutils literal notranslate"><span class="pre">DenseSymm</span></code> are now three-dimensional, not two-dimensional. Parameters saved from earlier implementations can be transformed to the new convention using <code class="docutils literal notranslate"><span class="pre">nk.nn.update_dense_symm</span></code>. <a class="reference external" href="https://github.com/netket/netket/pull/1030">#1030</a></p></li>
</ul>
</section>
<section id="deprecations">
<h3>Deprecations<a class="headerlink" href="#deprecations" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>The method <code class="docutils literal notranslate"><span class="pre">Sampler.samples</span></code> is added to return a generator of samples. The module functions <code class="docutils literal notranslate"><span class="pre">nk.sampler.sampler_state</span></code>, <code class="docutils literal notranslate"><span class="pre">reset</span></code>, <code class="docutils literal notranslate"><span class="pre">sample</span></code>, <code class="docutils literal notranslate"><span class="pre">samples</span></code>, and <code class="docutils literal notranslate"><span class="pre">sample_next</span></code> are deprecated in favor of the corresponding class methods. <a class="reference external" href="https://github.com/netket/netket/pull/1025">#1025</a></p></li>
<li><p>Kwarg <code class="docutils literal notranslate"><span class="pre">in_features</span></code> of <code class="docutils literal notranslate"><span class="pre">DenseEquivariant</span></code> is deprecated; the number of input features are inferred from the input. <a class="reference external" href="https://github.com/netket/netket/pull/1030">#1030</a></p></li>
<li><p>Kwarg <code class="docutils literal notranslate"><span class="pre">out_features</span></code> of <code class="docutils literal notranslate"><span class="pre">DenseEquivariant</span></code> is deprecated in favour of <code class="docutils literal notranslate"><span class="pre">features</span></code>. <a class="reference external" href="https://github.com/netket/netket/pull/1030">#1030</a></p></li>
</ul>
</section>
<section id="id5">
<h3>Internal Changes<a class="headerlink" href="#id5" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>The definitions of <code class="docutils literal notranslate"><span class="pre">MCState</span></code> and <code class="docutils literal notranslate"><span class="pre">MCMixedState</span></code> have been moved to an internal module, <code class="docutils literal notranslate"><span class="pre">nk.vqs.mc</span></code> that is hidden by default. <a class="reference external" href="https://github.com/netket/netket/pull/954">#954</a></p></li>
<li><p>Custom deepcopy for <code class="docutils literal notranslate"><span class="pre">LocalOperator</span></code> to avoid building <code class="docutils literal notranslate"><span class="pre">LocalOperator</span></code> from scratch each time it is copied <a class="reference external" href="https://github.com/netket/pull/964">#964</a></p></li>
</ul>
</section>
<section id="id6">
<h3>Bug Fixes<a class="headerlink" href="#id6" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>The constructor of <code class="docutils literal notranslate"><span class="pre">TensorHilbert</span></code> (which is used by the product operator <code class="docutils literal notranslate"><span class="pre">*</span></code> for inhomogeneous spaces) no longer fails when one of the component spaces is non-indexable. <a class="reference external" href="https://github.com/netket/netket/pull/1004">#1004</a></p></li>
<li><p>The <span class="xref std std-ref">nk.hilbert.random.flip_state</span> method used by <code class="docutils literal notranslate"><span class="pre">MetropolisLocal</span></code> now throws an error when called on a <span class="xref std std-ref">nk.hilbert.ContinuousHilbert</span> hilbert space instead of entering an endless loop. <a class="reference external" href="https://github.com/netket/netket/pull/1014">#1014</a></p></li>
<li><p>Fixed bug in conversion to qutip for <code class="docutils literal notranslate"><span class="pre">MCMixedState</span></code>, where the resulting shape (hilbert space size) was wrong. <a class="reference external" href="https://github.com/netket/netket/pull/1020">#1020</a></p></li>
<li><p>Setting <code class="docutils literal notranslate"><span class="pre">MCState.sampler</span></code> now recomputes <code class="docutils literal notranslate"><span class="pre">MCState.chain_length</span></code> according to <code class="docutils literal notranslate"><span class="pre">MCState.n_samples</span></code> and the new <code class="docutils literal notranslate"><span class="pre">sampler.n_chains</span></code>. <a class="reference external" href="https://github.com/netket/netket/pull/1028">#1028</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GCNN_Parity</span></code> allowed biasing both the parity-preserving and the parity-flip equivariant layers. These enter into the network output the same way, so having both is redundant and makes QGTs unstable. The biases of the parity-flip layers are now removed. <a class="reference external" href="https://github.com/netket/netket/pull/1030">#1030</a></p></li>
</ul>
</section>
</section>
<section id="netket-3-2-26-november-2021">
<h2>NetKet 3.2 (26 November 2021)<a class="headerlink" href="#netket-3-2-26-november-2021" title="Permalink to this headline">Â¶</a></h2>
<p><a class="reference external" href="https://github.com/netket/netket/compare/v3.1...v3.2">GitHub commits</a>.</p>
<section id="id7">
<h3>New features<a class="headerlink" href="#id7" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">GraphOperator</span></code> (and <code class="docutils literal notranslate"><span class="pre">Heisenberg</span></code>) now support passing a custom mapping of graph nodes to Hilbert space sites via the new <code class="docutils literal notranslate"><span class="pre">acting_on_subspace</span></code> argument. This makes it possible to create <code class="docutils literal notranslate"><span class="pre">GraphOperator</span></code>s that act on a subset of sites, which is useful in composite Hilbert spaces. <a class="reference external" href="https://github.com/netket/netket/pull/924">#924</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PauliString</span></code> now supports any Hilbert space with local size 2. The Hilbert space is now the optional first argument of the constructor. <a class="reference external" href="https://github.com/netket/netket/pull/960">#960</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PauliString</span></code> now can be multiplied and summed together, performing some simple algebraic simplifications on the strings they contain. They also lazily initialize their internal data structures, making them faster to construct but slightly slower the first time that their matrix elements are accessed. <a class="reference external" href="https://github.com/netket/netket/pull/955">#955</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PauliString</span></code>s can now be constructed starting from an <code class="docutils literal notranslate"><span class="pre">OpenFermion</span></code> operator. <a class="reference external" href="https://github.com/netket/netket/pull/956">#956</a></p></li>
<li><p>In addition to nearest-neighbor edges, <code class="docutils literal notranslate"><span class="pre">Lattice</span></code> can now generate edges between next-nearest and, more generally, k-nearest neighbors via the constructor argument <code class="docutils literal notranslate"><span class="pre">max_neighbor_order</span></code>. The edges can be distinguished by their <code class="docutils literal notranslate"><span class="pre">color</span></code> property (which is used, e.g., by <code class="docutils literal notranslate"><span class="pre">GraphOperator</span></code> to apply different bond operators). <a class="reference external" href="https://github.com/netket/netket/pull/970">#970</a></p></li>
<li><p>Two continuous-space operators (<code class="docutils literal notranslate"><span class="pre">KineticEnergy</span></code> and <code class="docutils literal notranslate"><span class="pre">PotentialEnergy</span></code>) have been implemented. <a class="reference external" href="https://github.com/netket/netket/pull/971">#971</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Heisenberg</span></code> Hamiltonians support different coupling strengths on <code class="docutils literal notranslate"><span class="pre">Graph</span></code> edges with different colors. <a class="reference external" href="https://github.com/netket/netket/pull/972">#972</a>.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">little_group</span></code> and <code class="docutils literal notranslate"><span class="pre">space_group_irreps</span></code> methods of <code class="docutils literal notranslate"><span class="pre">SpaceGroupBuilder</span></code> take the wave vector as either varargs or iterables. <a class="reference external" href="https://github.com/netket/netket/pull/975">#975</a></p></li>
<li><p>A new <code class="docutils literal notranslate"><span class="pre">netket.experimental</span></code> submodule has been created and all experimental features have been moved there. Note that in contrast to the other <code class="docutils literal notranslate"><span class="pre">netket</span></code> submodules, <code class="docutils literal notranslate"><span class="pre">netket.experimental</span></code> is not imported by default. <a class="reference external" href="https://github.com/netket/netket/pull/976">#976</a></p></li>
</ul>
</section>
<section id="id8">
<h3>Breaking Changes<a class="headerlink" href="#id8" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>Moved <code class="docutils literal notranslate"><span class="pre">nk.vqs.variables_from_***</span></code> to <code class="docutils literal notranslate"><span class="pre">nk.experimental.vqs</span></code> module. Also moved the experimental samplers to <code class="docutils literal notranslate"><span class="pre">nk.sampler.MetropolisPt</span></code> and <code class="docutils literal notranslate"><span class="pre">nk.sampler.MetropolisPmap</span></code> to <code class="docutils literal notranslate"><span class="pre">nk.experimental.sampler</span></code>. <a class="reference external" href="https://github.com/netket/netket/pull/976">#976</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">operator.size</span></code>, has been deprecated. If you were using this function, please transition to <code class="docutils literal notranslate"><span class="pre">operator.hilbert.size</span></code>. <a class="reference external" href="https://github.com/netket/netket/pull/985">#985</a></p></li>
</ul>
</section>
<section id="id9">
<h3>Bug Fixes<a class="headerlink" href="#id9" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>A bug where <code class="docutils literal notranslate"><span class="pre">LocalOperator.get_conn_flattened</span></code> would read out-of-bounds memory has been fixed. It is unlikely that the bug was causing problems, but it triggered warnings when running Numba with boundscheck activated. <a class="reference external" href="https://github.com/netket/netket/pull/966">#966</a></p></li>
<li><p>The dependency <code class="docutils literal notranslate"><span class="pre">python-igraph</span></code> has been updated to <code class="docutils literal notranslate"><span class="pre">igraph</span></code> following the rename of the upstream project in order to work on conda. <a class="reference external" href="https://github.com/netket/netket/pull/986">#986</a></p></li>
<li><p><a class="reference internal" href="../api/_generated/vqs/netket.vqs.MCState.html#netket.vqs.MCState.n_samples_per_rank" title="netket.vqs.MCState.n_samples_per_rank"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_samples_per_rank</span></code></a> was returning wrong values and has now been fixed. <a class="reference external" href="https://github.com/netket/netket/pull/987">#987</a></p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">DenseSymm</span></code> layer now also accepts objects of type <code class="docutils literal notranslate"><span class="pre">HashableArray</span></code> as <code class="docutils literal notranslate"><span class="pre">symmetries</span></code> argument. <a class="reference external" href="https://github.com/netket/netket/pull/989">#989</a></p></li>
<li><p>A bug where <code class="docutils literal notranslate"><span class="pre">VMC.info()</span></code> was erroring has been fixed. <a class="reference external" href="https://github.com/netket/netket/pull/984">#984</a></p></li>
</ul>
</section>
</section>
<section id="netket-3-1-20-october-2021">
<h2>NetKet 3.1 (20 October 2021)<a class="headerlink" href="#netket-3-1-20-october-2021" title="Permalink to this headline">Â¶</a></h2>
<p><a class="reference external" href="https://github.com/netket/netket/compare/v3.0...v3.1">GitHub commits</a>.</p>
<section id="id10">
<h3>New features<a class="headerlink" href="#id10" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>Added Conversion methods <code class="docutils literal notranslate"><span class="pre">to_qobj()</span></code> to operators and variational states, that produce QuTiPâ€™s qobjects.</p></li>
<li><p>A function <code class="docutils literal notranslate"><span class="pre">nk.nn.activation.reim</span></code> has been added that transforms a nonlinearity to act seperately on the real and imaginary parts</p></li>
<li><p>Nonlinearities <code class="docutils literal notranslate"><span class="pre">reim_selu</span></code> and <code class="docutils literal notranslate"><span class="pre">reim_relu</span></code> have been added</p></li>
<li><p>Autoregressive Neural Networks (ARNN) now have a <code class="docutils literal notranslate"><span class="pre">machine_pow</span></code> field (defaults to 2) used to change the exponent used for the normalization of the wavefunction. <a class="reference external" href="https://github.com/netket/netket/pull/940">#940</a>.</p></li>
</ul>
</section>
<section id="id11">
<h3>Breaking Changes<a class="headerlink" href="#id11" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>The default initializer for <code class="docutils literal notranslate"><span class="pre">netket.models.GCNN</span></code> has been changed to from <code class="docutils literal notranslate"><span class="pre">jax.nn.selu</span></code> to <code class="docutils literal notranslate"><span class="pre">netket.nn.reim_selu</span></code> <a class="reference external" href="https://github.com/netket/netket/pull/892">#892</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">netket.nn.initializers</span></code> has been deprecated in favor of <code class="docutils literal notranslate"><span class="pre">jax.nn.initializers</span></code> <a class="reference external" href="https://github.com/netket/netket/pull/935">#935</a>.</p></li>
<li><p>Subclasses of <code class="docutils literal notranslate"><span class="pre">AbstractARNN</span></code> must define the field <code class="docutils literal notranslate"><span class="pre">machine_pow</span></code> <a class="reference external" href="https://github.com/netket/netket/pull/940">#940</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nk.hilbert.HilbertIndex</span></code> and <code class="docutils literal notranslate"><span class="pre">nk.operator.spin.DType</span></code> are now unexported (they where never intended to be visible).  <a class="reference external" href="https://github.com/netket/netket/pull/904">#904</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AbstractOperator</span></code>s have been renamed <code class="docutils literal notranslate"><span class="pre">DiscreteOperator</span></code>s. <code class="docutils literal notranslate"><span class="pre">AbstractOperator</span></code>s still exist, but have almost no functionality and they are intended as the base class for more arbitrary (eg. continuous space) operators. If you have defined a custom operator inheriting from <code class="docutils literal notranslate"><span class="pre">AbstractOperator</span></code> you should change it to derive from <code class="docutils literal notranslate"><span class="pre">DiscreteOperator</span></code>. <a class="reference external" href="https://github.com/netket/netket/pull/929">#929</a></p></li>
</ul>
</section>
<section id="id12">
<h3>Internal Changes<a class="headerlink" href="#id12" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">PermutationGroup.product_table</span></code> now consumes less memory and is more performant. This is helpfull when working with large symmetry groups. <a class="reference external" href="https://github.com/netket/netket/pull/884">#884</a> <a class="reference external" href="https://github.com/netket/netket/pull/891">#891</a></p></li>
<li><p>Added size check to <code class="docutils literal notranslate"><span class="pre">DiscreteOperator.get_conn</span></code> and throw helpful error messages if those do not match. <a class="reference external" href="https://github.com/netket/netket/pull/927">#927</a></p></li>
<li><p>The internal <code class="docutils literal notranslate"><span class="pre">numba4jax</span></code> module has been factored out into a standalone library, named (how original) <a class="reference external" href="http://github.com/PhilipVinc/numba4jax"><code class="docutils literal notranslate"><span class="pre">numba4jax</span></code></a>. This library was never intended to be used by external users, but if for any reason you were using it, you should switch to the external library. <a class="reference external" href="https://github.com/netket/netket/pull/934">#934</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">netket.jax</span></code> now includes several <em>batching</em> utilities like <code class="docutils literal notranslate"><span class="pre">batched_vmap</span></code> and <code class="docutils literal notranslate"><span class="pre">batched_vjp</span></code>. Those can be used to build memory efficient batched code, but are considered internal, experimental and might change without warning. <a class="reference external" href="https://github.com/netket/netket/pull/925">#925</a>.</p></li>
</ul>
</section>
<section id="id13">
<h3>Bug Fixes<a class="headerlink" href="#id13" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>Autoregressive networks now work with <code class="docutils literal notranslate"><span class="pre">Qubit</span></code> hilbert spaces. <a class="reference external" href="https://github.com/netket/netket/pull/937">#937</a></p></li>
</ul>
</section>
</section>
<section id="netket-3-0-23-august-2021">
<h2>NetKet 3.0 (23 august 2021)<a class="headerlink" href="#netket-3-0-23-august-2021" title="Permalink to this headline">Â¶</a></h2>
<p><a class="reference external" href="https://github.com/netket/netket/compare/v3.0b4...v3.0">GitHub commits</a>.</p>
<section id="id14">
<h3>New features<a class="headerlink" href="#id14" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="id15">
<h3>Breaking Changes<a class="headerlink" href="#id15" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>The default initializer for <code class="docutils literal notranslate"><span class="pre">netket.nn.Dense</span></code> layers now matches the same default as <code class="docutils literal notranslate"><span class="pre">flax.linen</span></code>, and it is <code class="docutils literal notranslate"><span class="pre">lecun_normal</span></code> instead of <code class="docutils literal notranslate"><span class="pre">normal(0.01)</span></code> <a class="reference external" href="https://github.com/netket/netket/pull/869">#869</a></p></li>
<li><p>The default initializer for <code class="docutils literal notranslate"><span class="pre">netket.nn.DenseSymm</span></code> layers is now chosen in order to give variance 1 to every output channel, therefore defaulting to <code class="docutils literal notranslate"><span class="pre">lecun_normal</span></code> <a class="reference external" href="https://github.com/netket/netket/pull/870">#870</a></p></li>
</ul>
</section>
<section id="id16">
<h3>Internal Changes<a class="headerlink" href="#id16" title="Permalink to this headline">Â¶</a></h3>
</section>
<section id="id17">
<h3>Bug Fixes<a class="headerlink" href="#id17" title="Permalink to this headline">Â¶</a></h3>
</section>
</section>
<section id="netket-3-0b4-17-august-2021">
<h2>NetKet 3.0b4 (17 august 2021)<a class="headerlink" href="#netket-3-0b4-17-august-2021" title="Permalink to this headline">Â¶</a></h2>
<p><a class="reference external" href="https://github.com/netket/netket/compare/v3.0b3...v3.0b4">GitHub commits</a>.</p>
<section id="id18">
<h3>New features<a class="headerlink" href="#id18" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>DenseSymm now accepts a mode argument to specify whever the symmetries should be computed with a full dense matrix or FFT. The latter method is much faster for sufficiently large systems. Other kwargs have been added to satisfy the interface. The api changes are also reflected in RBMSymm and GCNN. <a class="reference external" href="https://github.com/netket/netket/pull/792">#792</a></p></li>
</ul>
</section>
<section id="id19">
<h3>Breaking Changes<a class="headerlink" href="#id19" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>The so-called legacy netket in <code class="docutils literal notranslate"><span class="pre">netket.legacy</span></code> has been removed. <a class="reference external" href="https://github.com/netket/netket/pull/773">#773</a></p></li>
</ul>
</section>
<section id="id20">
<h3>Internal Changes<a class="headerlink" href="#id20" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>The methods <code class="docutils literal notranslate"><span class="pre">expect</span></code> and <code class="docutils literal notranslate"><span class="pre">expect_and_grad</span></code> of <code class="docutils literal notranslate"><span class="pre">MCState</span></code> now use dispatch to select the relevant implementation of the algorithm. They can therefore be expanded and overridden without editing NetKetâ€™s source code. <a class="reference external" href="https://github.com/netket/netket/pull/804">#804</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">netket.utils.mpi_available</span></code> has been moved to <code class="docutils literal notranslate"><span class="pre">netket.utils.mpi.available</span></code> to have a more consistent api interface (all mpi-related properties in the same submodule). <a class="reference external" href="https://github.com/netket/netket/pull/827">#827</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">netket.logging.TBLog</span></code> has been renamed to <code class="docutils literal notranslate"><span class="pre">netket.logging.TensorBoardLog</span></code> for better readability. A deprecation warning is now issued if the older name is used <a class="reference external" href="https://github.com/netket/netket/pull/827">#827</a></p></li>
<li><p>When <code class="docutils literal notranslate"><span class="pre">MCState</span></code> initializes a model by calling <code class="docutils literal notranslate"><span class="pre">model.init</span></code>, the call is now jitted. This should speed it up for non-trivial models but might break non-jit invariant models.  <a class="reference external" href="https://github.com/netket/netket/pull/832">#832</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">operator.get_conn_padded</span></code> now supports arbitrarily-dimensioned bitstrings as input and reshapes the output accordingly.  <a class="reference external" href="https://github.com/netket/netket/pull/834">#834</a></p></li>
<li><p>NetKetâ€™s implementation of dataclasses now support <code class="docutils literal notranslate"><span class="pre">pytree_node=True/False</span></code> on cached properties. <a class="reference external" href="https://github.com/netket/netket/pull/835">#835</a></p></li>
<li><p>Plum version has been bumped to 1.5.1 to avoid broken versions (1.4, 1.5). <a class="reference external" href="https://github.com/netket/netket/pull/856">#856</a>.</p></li>
<li><p>Numba version 0.54 is now allowed <a class="reference external" href="https://github.com/netket/netket/pull/857">#857</a>.</p></li>
</ul>
</section>
<section id="id21">
<h3>Bug Fixes<a class="headerlink" href="#id21" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>Fix Progress bar bug. <a class="reference external" href="https://github.com/netket/netket/pull/810">#810</a></p></li>
<li><p>Make the repr/printing of history objects nicer in the REPL. <a class="reference external" href="https://github.com/netket/netket/pull/819">#819</a></p></li>
<li><p>The field <code class="docutils literal notranslate"><span class="pre">MCState.model</span></code> is now read-only, to prevent user errors. <a class="reference external" href="https://github.com/netket/netket/pull/822">#822</a></p></li>
<li><p>The order of the operators in <code class="docutils literal notranslate"><span class="pre">PauliString</span></code> does no longer influences the estimate of the number of non-zero connected elements. <a class="reference external" href="https://github.com/netket/netket/pull/836">#836</a></p></li>
</ul>
</section>
</section>
<section id="netket-3-0b3-published-on-9-july-2021">
<h2>NetKet 3.0b3 (published on 9 july 2021)<a class="headerlink" href="#netket-3-0b3-published-on-9-july-2021" title="Permalink to this headline">Â¶</a></h2>
<p><a class="reference external" href="https://github.com/netket/netket/compare/v3.0b2...v3.0b3">GitHub commits</a>.</p>
<section id="id22">
<h3>New features<a class="headerlink" href="#id22" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>The <span class="xref std std-ref">netket.utils.group</span> submodule provides utilities for geometrical and permutation groups. <code class="docutils literal notranslate"><span class="pre">Lattice</span></code> (and its specialisations like <code class="docutils literal notranslate"><span class="pre">Grid</span></code>) use these to automatically construct the space groups of lattices, as well as their character tables for generating wave functions with broken symmetry. <a class="reference external" href="https://github.com/netket/netket/pull/724">#724</a></p></li>
<li><p>Autoregressive neural networks, sampler, and masked linear layers have been added to <code class="docutils literal notranslate"><span class="pre">models</span></code>, <code class="docutils literal notranslate"><span class="pre">sampler</span></code> and <code class="docutils literal notranslate"><span class="pre">nn</span></code> <a class="reference external" href="https://github.com/netket/netket/pull/705">#705</a>.</p></li>
</ul>
</section>
<section id="id23">
<h3>Breaking Changes<a class="headerlink" href="#id23" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">netket.graph.Grid</span></code> class has been removed. <a class="reference internal" href="../api/_generated/graph/netket.graph.Grid.html#netket-graph-grid"><span class="std std-ref">netket.graph.Grid</span></a> will now return an instance of <span class="xref std std-ref">graph.Lattice</span> supporting the same API but with new functionalities related to spatial symmetries. The <code class="docutils literal notranslate"><span class="pre">color_edges</span></code> optional keyword argument has been removed without deprecation. <a class="reference external" href="https://github.com/netket/netket/pull/724">#724</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MCState.n_discard</span></code> has been renamed <code class="docutils literal notranslate"><span class="pre">MCState.n_discard_per_chain</span></code> and the old binding has been deprecated <a class="reference external" href="https://github.com/netket/netket/pull/739">#739</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nk.optimizer.qgt.QGTOnTheFly</span></code> option <code class="docutils literal notranslate"><span class="pre">centered=True</span></code> has been removed because we are now convinced the two options yielded equivalent results. <code class="docutils literal notranslate"><span class="pre">QGTOnTheFly</span></code> now always behaves as if <code class="docutils literal notranslate"><span class="pre">centered=False</span></code> <a class="reference external" href="https://github.com/netket/netket/pull/706">#706</a>.</p></li>
</ul>
</section>
<section id="id24">
<h3>Internal Changes<a class="headerlink" href="#id24" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">networkX</span></code> has been replaced by <code class="docutils literal notranslate"><span class="pre">igraph</span></code>, yielding a considerable speedup for some graph-related operations <a class="reference external" href="https://github.com/netket/netket/pull/729">#729</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">netket.hilbert.random</span></code> module now uses <code class="docutils literal notranslate"><span class="pre">plum-dispatch</span></code> (through <code class="docutils literal notranslate"><span class="pre">netket.utils.dispatch</span></code>) to select the correct implementation of <code class="docutils literal notranslate"><span class="pre">random_state</span></code> and <code class="docutils literal notranslate"><span class="pre">flip_state</span></code>. This makes it easy to define new hilbert states and extend their functionality easily.  <a class="reference external" href="https://github.com/netket/netket/pull/734">#734</a>.</p></li>
<li><p>The AbstractHilbert interface is now much smaller in order to also support continuous Hilbert spaces. Any functionality specific to discrete hilbert spaces (what was previously supported) has been moved to a new abstract type <code class="docutils literal notranslate"><span class="pre">netket.hilbert.DiscreteHilbert</span></code>. Any Hilbert space previously subclassing <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.AbstractHilbert.html#netket-hilbert-abstracthilbert"><span class="std std-ref">netket.hilbert.AbstractHilbert</span></a> should be modified to subclass <a class="reference internal" href="../api/_generated/hilbert/netket.hilbert.DiscreteHilbert.html#netket-hilbert-discretehilbert"><span class="std std-ref">netket.hilbert.DiscreteHilbert</span></a> <a class="reference external" href="https://github.com/netket/netket/pull/800">#800</a>.</p></li>
</ul>
</section>
<section id="id25">
<h3>Bug Fixes<a class="headerlink" href="#id25" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">nn.to_array</span></code> and <code class="docutils literal notranslate"><span class="pre">MCState.to_array</span></code>, if <code class="docutils literal notranslate"><span class="pre">normalize=False</span></code>, do not subtract the logarithm of the maximum value from the state  <a class="reference external" href="https://github.com/netket/netket/pull/705">#705</a>.</p></li>
<li><p>Autoregressive networks now work with Fock space and give correct errors if the hilbert space is not supported  <a class="reference external" href="https://github.com/netket/netket/pull/806">#806</a>.</p></li>
<li><p>Autoregressive networks are now much (x10-x100) faster  <a class="reference external" href="https://github.com/netket/netket/pull/705">#705</a>.</p></li>
<li><p>Do not throw errors when calling <code class="docutils literal notranslate"><span class="pre">operator.get_conn_flattened(states)</span></code> with a jax array  <a class="reference external" href="https://github.com/netket/netket/pull/764">#764</a>.</p></li>
<li><p>Fix bug with the driver progress bar when <code class="docutils literal notranslate"><span class="pre">step_size</span> <span class="pre">!=</span> <span class="pre">1</span></code>  <a class="reference external" href="https://github.com/netket/netket/pull/747">#747</a>.</p></li>
</ul>
</section>
</section>
<section id="netket-3-0b2-published-on-31-may-2021">
<h2>NetKet 3.0b2 (published on 31 May 2021)<a class="headerlink" href="#netket-3-0b2-published-on-31-may-2021" title="Permalink to this headline">Â¶</a></h2>
<p><a class="reference external" href="https://github.com/netket/netket/compare/v3.0b1...v3.0b2">GitHub commits</a>.</p>
<section id="id26">
<h3>New features<a class="headerlink" href="#id26" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>Group Equivariant Neural Networks have been added to <code class="docutils literal notranslate"><span class="pre">models</span></code> <a class="reference external" href="https://github.com/netket/netket/pull/620">#620</a></p></li>
<li><p>Permutation invariant RBM and Permutation invariant dense layer have been added to <code class="docutils literal notranslate"><span class="pre">models</span></code>
and <code class="docutils literal notranslate"><span class="pre">nn.linear</span></code> <a class="reference external" href="https://github.com/netket/netket/pull/573">#573</a></p></li>
<li><p>Add the property <code class="docutils literal notranslate"><span class="pre">acceptance</span></code> to <code class="docutils literal notranslate"><span class="pre">MetropolisSampler</span></code>â€™s <code class="docutils literal notranslate"><span class="pre">SamplerState</span></code>, computing the
MPI-enabled acceptance ratio. <a class="reference external" href="https://github.com/netket/netket/pull/592">#592</a>.</p></li>
<li><p>Add <code class="docutils literal notranslate"><span class="pre">StateLog</span></code>, a new logger that stores the parameters of the model during the
optimization in a folder or in a tar file. <a class="reference external" href="https://github.com/netket/netket/pull/645">#645</a></p></li>
<li><p>A warning is now issued if NetKet detects to be running under <code class="docutils literal notranslate"><span class="pre">mpirun</span></code> but MPI dependencies
are not installed <a class="reference external" href="https://github.com/netket/netket/pull/631">#631</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">operator.LocalOperator</span></code>s now do not return a zero matrix element on the diagonal if the whole
diagonal is zero. <a class="reference external" href="https://github.com/netket/netket/pull/623">#623</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">logger.JSONLog</span></code> now automatically flushes at every iteration if it does not consume significant
CPU cycles. <a class="reference external" href="https://github.com/netket/netket/pull/599">#599</a></p></li>
<li><p>The interface of Stochastic Reconfiguration has been overhauled and made more modular. You can now
specify the solver you wish to use, NetKet provides some dense solvers out of the box, and there are
3 different ways to compute the Quantum Geometric Tensor. Read the documentation to learn more about
it. <a class="reference external" href="https://github.com/netket/netket/pull/674">#674</a></p></li>
<li><p>Unless you specify the QGT implementation you wish to use with SR, we use an automatic heuristic based
on your model and the solver to pick one.
This might affect SR performance. <a class="reference external" href="https://github.com/netket/netket/pull/674">#674</a></p></li>
</ul>
</section>
<section id="id27">
<h3>Breaking Changes<a class="headerlink" href="#id27" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>For all samplers, <code class="docutils literal notranslate"><span class="pre">n_chains</span></code> now sets the <em>total</em> number of chains across all MPI ranks. This is a breaking change
compared to the old API, where <code class="docutils literal notranslate"><span class="pre">n_chains</span></code> would set the number of chains on a single MPI rank. It is still possible to
set the number of chains per MPI rank by specifying <code class="docutils literal notranslate"><span class="pre">n_chains_per_rank</span></code> instead of <code class="docutils literal notranslate"><span class="pre">n_chains</span></code>. This change, while breaking
allows us to be consistent with the interface of <span class="xref std std-ref">variational.MCState</span>, where <code class="docutils literal notranslate"><span class="pre">n_samples</span></code> is the total number of samples
across MPI nodes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MetropolisSampler.reset_chain</span></code> has been renamed to <code class="docutils literal notranslate"><span class="pre">MetropolisSampler.reset_chains</span></code>.
Likewise in the constructor of all samplers.</p></li>
<li><p>Briefly during development releases <code class="docutils literal notranslate"><span class="pre">MetropolisSamplerState.acceptance_ratio</span></code> returned
the percentage (not ratio) of acceptance. <code class="docutils literal notranslate"><span class="pre">acceptance_ratio</span></code> is now deprecated in
favour of the correct <code class="docutils literal notranslate"><span class="pre">acceptance</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">models.Jastrow</span></code> now internally symmetrizes the matrix before computing its value <a class="reference external" href="https://github.com/netket/netket/pull/644">#644</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MCState.evaluate</span></code> has been renamed to <code class="docutils literal notranslate"><span class="pre">MCState.log_value</span></code> <a class="reference external" href="https://github.com/netket/netket/pull/632">#632</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nk.optimizer.SR</span></code> no longer accepts keyword argument relative to the sparse solver. Those should be passed
inside the closure or <code class="docutils literal notranslate"><span class="pre">functools.partial</span></code> passed as <code class="docutils literal notranslate"><span class="pre">solver</span></code> argument.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nk.optimizer.sr.SRLazyCG</span></code> and <code class="docutils literal notranslate"><span class="pre">nk.optimizer.sr.SRLazyGMRES</span></code> have been deprecated and will soon be removed.</p></li>
<li><p>Parts of the <code class="docutils literal notranslate"><span class="pre">Lattice</span></code> API have been overhauled, with deprecations of several methods in favor of a consistent usage of <code class="docutils literal notranslate"><span class="pre">Lattice.position</span></code> for real-space location of sites and <code class="docutils literal notranslate"><span class="pre">Lattice.basis_coords</span></code> for location of sites in terms of basis vectors. <code class="docutils literal notranslate"><span class="pre">Lattice.sites</span></code> has been added, which provides a sequence of <code class="docutils literal notranslate"><span class="pre">LatticeSite</span></code> objects combining all site properties. Furthermore, <code class="docutils literal notranslate"><span class="pre">Lattice</span></code> now provides lookup of sites from their position via <code class="docutils literal notranslate"><span class="pre">id_from_position</span></code> using a hashing scheme that works across periodic boundaries. <a class="reference external" href="https://github.com/netket/netket/pull/703">#703</a> <a class="reference external" href="https://github.com/netket/netket/pull/715">#715</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nk.variational</span></code> has been renamed to <code class="docutils literal notranslate"><span class="pre">nk.vqs</span></code> and will be removed in a future release.</p></li>
</ul>
</section>
<section id="id28">
<h3>Bug Fixes<a class="headerlink" href="#id28" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>Fix <code class="docutils literal notranslate"><span class="pre">operator.BoseHubbard</span></code> usage under jax Hamiltonian Sampling <a class="reference external" href="https://github.com/netket/netket/pull/662">#662</a></p></li>
<li><p>Fix <code class="docutils literal notranslate"><span class="pre">SROnTheFly</span></code> for <code class="docutils literal notranslate"><span class="pre">R-&gt;C</span></code> models with non homogeneous parameters <a class="reference external" href="https://github.com/netket/netket/pull/661">#661</a></p></li>
<li><p>Fix MPI Compilation deadlock when computing expectation values <a class="reference external" href="https://github.com/netket/netket/pull/655">#655</a></p></li>
<li><p>Fix bug preventing the creation of a <code class="docutils literal notranslate"><span class="pre">hilbert.Spin</span></code> Hilbert space with odd sites and even <code class="docutils literal notranslate"><span class="pre">S</span></code>. <a class="reference external" href="https://github.com/netket/netket/pull/641">#641</a></p></li>
<li><p>Fix bug <a class="reference external" href="https://github.com/netket/netket/pull/635">#635</a> preventing the usage of <code class="docutils literal notranslate"><span class="pre">NumpyMetropolisSampler</span></code> with <code class="docutils literal notranslate"><span class="pre">MCState.expect</span></code> <a class="reference external" href="https://github.com/netket/netket/pull/635">#635</a></p></li>
<li><p>Fix bug <a class="reference external" href="https://github.com/netket/netket/pull/635">#635</a> where the <code class="docutils literal notranslate"><span class="pre">graph.Lattice</span></code> was not correctly computing neighbours because of floating point issues. <a class="reference external" href="https://github.com/netket/netket/pull/633">#633</a></p></li>
<li><p>Fix bug the Y Pauli matrix, which was stored as its conjugate. <a class="reference external" href="https://github.com/netket/netket/pull/618">#618</a> <a class="reference external" href="https://github.com/netket/netket/pull/617">#617</a> <a class="reference external" href="https://github.com/netket/netket/pull/615">#615</a></p></li>
</ul>
</section>
</section>
<section id="netket-3-0b1-published-beta-release">
<h2>NetKet 3.0b1 (published beta release)<a class="headerlink" href="#netket-3-0b1-published-beta-release" title="Permalink to this headline">Â¶</a></h2>
<p><a class="reference external" href="https://github.com/netket/netket/compare/v2.1.1...v3.0b1">GitHub commits</a>.</p>
<section id="api-changes">
<h3>API Changes<a class="headerlink" href="#api-changes" title="Permalink to this headline">Â¶</a></h3>
<ul class="simple">
<li><p>Hilbert space constructors do not store the lattice graph anymore. As a consequence, the constructor does not accept the graph anymore.</p></li>
<li><p>Special Hamiltonians defined on a lattice, such as <a class="reference internal" href="../api/_generated/operator/netket.operator.BoseHubbard.html#netket.operator.BoseHubbard" title="netket.operator.BoseHubbard"><code class="xref py py-class docutils literal notranslate"><span class="pre">operator.BoseHubbard</span></code></a>, <a class="reference internal" href="../api/_generated/operator/netket.operator.Ising.html#netket.operator.Ising" title="netket.operator.Ising"><code class="xref py py-class docutils literal notranslate"><span class="pre">operator.Ising</span></code></a> and <a class="reference internal" href="../api/_generated/operator/netket.operator.Heisenberg.html#netket.operator.Heisenberg" title="netket.operator.Heisenberg"><code class="xref py py-class docutils literal notranslate"><span class="pre">operator.Heisenberg</span></code></a>, now require the graph to be passed explicitly through a <code class="docutils literal notranslate"><span class="pre">graph</span></code> keyword argument.</p></li>
<li><p><a class="reference internal" href="../api/_generated/operator/netket.operator.LocalOperator.html#netket.operator.LocalOperator" title="netket.operator.LocalOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">operator.LocalOperator</span></code></a> now default to real-valued matrix elements, except if you construct them with a complex-valued matrix. This is also valid for operators such as :func:<code class="docutils literal notranslate"><span class="pre">operator.spin.sigmax</span></code> and similars.</p></li>
<li><p>When performing algebraic operations <code class="code docutils literal notranslate"><span class="pre">*,</span> <span class="pre">-,</span> <span class="pre">+</span></code> on pairs of <a class="reference internal" href="../api/_generated/operator/netket.operator.LocalOperator.html#netket.operator.LocalOperator" title="netket.operator.LocalOperator"><code class="xref py py-class docutils literal notranslate"><span class="pre">operator.LocalOperator</span></code></a>, the dtype of the result iscomputed using standard numpy promotion logic.</p>
<ul>
<li><p>Doing an operation in-place <code class="code docutils literal notranslate"><span class="pre">+=,</span> <span class="pre">-=,</span> <span class="pre">*=</span></code> on a real-valued operator will now fail if the other is complex. While this might seem annoying, itâ€™s useful to ensure that smaller types such as <code class="docutils literal notranslate"><span class="pre">float32</span></code> or <code class="docutils literal notranslate"><span class="pre">complex64</span></code> are preserved if the user desires to do so.</p></li>
</ul>
</li>
<li><p><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractMachine</span></code> has been removed. Itâ€™s functionality is now split among the model itself, which is defined by the user and <code class="xref py py-class docutils literal notranslate"><span class="pre">variational.MCState</span></code> for pure states or <code class="xref py py-class docutils literal notranslate"><span class="pre">variational.MCMixedState</span></code> for mixed states.</p>
<ul>
<li><p>The model, in general is composed by two functions, or an object with two functions: an <code class="docutils literal notranslate"><span class="pre">init(rng,</span> <span class="pre">sample_val)</span></code> function, accepting a <a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.random.PRNGKey.html#jax.random.PRNGKey" title="(in JAX)"><code class="xref py py-func docutils literal notranslate"><span class="pre">jax.random.PRNGKey()</span></code></a> object and an input, returning the parameters and the state of the model for that particular sample shape, and a <code class="code docutils literal notranslate"><span class="pre">apply(params,</span> <span class="pre">samples,</span> <span class="pre">**kwargs)</span></code> function, evaluating the model for the given parameters and inputs.</p></li>
<li><p>Some models (previously machines) such as the RBM (Restricted Boltzmann Machine) Machine, NDM (Neural Density Matrix) or MPS (Matrix Product State ansatz) are available in <a class="reference internal" href="../api/models.html#pre-built-models"><span class="std std-ref">Pre-built models</span></a>.</p></li>
<li><p>Machines, now called models, should be written using <a class="reference external" href="https://flax.readthedocs.io/en/latest">Flax</a> or another jax framework.</p></li>
<li><p>Serialization and deserialization functionality has now been moved to <span class="xref std std-ref">netket.variational.MCState</span>, which support the standard Flax interface through MsgPack. See <a class="reference external" href="https://flax.readthedocs.io/en/latest/flax.serialization.html">Flax docs</a> for more information</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">AbstractMachine.init_random_parameters</span></code> functionality has now been absorbed into <a class="reference internal" href="../api/_generated/vqs/netket.vqs.VariationalState.html#netket.vqs.VariationalState.init_parameters" title="netket.vqs.VariationalState.init_parameters"><code class="xref py py-meth docutils literal notranslate"><span class="pre">netket.vqs.VariationalState.init_parameters()</span></code></a>, which however has a different syntax.</p></li>
</ul>
</li>
<li><p><span class="xref std std-ref">Samplers</span> now require the Hilbert space upon which they sample to be passed in to the constructor.
Also note that several keyword arguments of the samplers have changed, and new one are available.</p></li>
<li><p>Itâ€™s now possible to change <span class="xref std std-ref">Samplers</span> dtype, which controls the type of the output. By default they use double-precision samples (<code class="docutils literal notranslate"><span class="pre">np.float64</span></code>). Be wary of type promotion issues with your models.</p></li>
<li><p><span class="xref std std-ref">Samplers</span> no longer take a machine as an argument.</p></li>
<li><p><span class="xref std std-ref">Samplers</span> are now immutable (frozen) <code class="docutils literal notranslate"><span class="pre">dataclasses</span></code> (defined through <code class="docutils literal notranslate"><span class="pre">flax.struct.dataclass</span></code>) that only hold the sampling parameters. As a consequence it is no longer possible to change their settings such as <code class="docutils literal notranslate"><span class="pre">n_chains</span></code> or <code class="docutils literal notranslate"><span class="pre">n_sweeps</span></code> without creating a new sampler. If you wish to update only one parameter, it is possible to construct the new sampler with the updated value by using the <code class="docutils literal notranslate"><span class="pre">sampler.replace(parameter=new_value)</span></code> function.</p></li>
<li><p><span class="xref std std-ref">Samplers</span> are no longer stateful objects. Instead, they can construct an immutable state object <span class="xref std std-ref">netket.sampler.init_state</span>, which can be passed to sampling functions such as <span class="xref std std-ref">netket.sampler.sample</span>, which now return also the updated state. However, unless you have particular use-cases we advise you use the variational state <a class="reference internal" href="varstate.html#mcstate"><span class="std std-ref">MCState</span></a> instead.</p></li>
<li><p>The <a class="reference internal" href="../api/optimizer.html#netket-optimizer"><span class="std std-ref">netket.optimizer</span></a> module has been overhauled, and now only re-exports flax optim module. We advise not to use netketâ€™s optimizer but instead to use <a class="reference external" href="https://github.com/deepmind/optax%3E">optax</a> .</p></li>
<li><p>The <a class="reference internal" href="../api/_generated/optim/netket.optimizer.SR.html#netket-optimizer-sr"><span class="std std-ref">netket.optimizer.SR</span></a> object now is only a set of options used to compute the SR matrix. The SR matrix, now called <code class="docutils literal notranslate"><span class="pre">quantum_geometric_tensor</span></code> can be obtained by calling <code class="xref py py-meth docutils literal notranslate"><span class="pre">variational.MCState.quantum_geometric_tensor()</span></code>. Depending on the settings, this can be a lazy object.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">netket.Vmc</span></code> has been renamed to <span class="xref std std-ref">netket.VMC</span></p></li>
<li><p><a class="reference internal" href="../api/_generated/models/netket.models.RBM.html#netket-models-rbm"><span class="std std-ref">netket.models.RBM</span></a> replaces the old <code class="code docutils literal notranslate"><span class="pre">RBM</span></code> machine, but has real parameters by default.</p></li>
<li><p>As we rely on Jax, using <code class="code docutils literal notranslate"><span class="pre">dtype=float</span></code> or <code class="code docutils literal notranslate"><span class="pre">dtype=complex</span></code>, which are weak types, will sometimes lead to loss of precision because they might be converted to <code class="docutils literal notranslate"><span class="pre">float32</span></code>. Use <code class="code docutils literal notranslate"><span class="pre">np.float64</span></code> or <code class="code docutils literal notranslate"><span class="pre">np.complex128</span></code> instead if you want double precision when defining your models.</p></li>
</ul>
</section>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../tutorials/G-CNN_Honeycomb.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Symmetries: Honeycomb Heisenberg model</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="superop.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">The Lindblad Master Equation</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Giuseppe Carleo et al.<br/>
  
      &copy; Copyright 2019-2021, The Netket authors - All rights reserved.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  
  <script src="../_static/scripts/sphinx-book-theme.js?digest=da817022793a90a681ee"></script>


  </body>
</html>